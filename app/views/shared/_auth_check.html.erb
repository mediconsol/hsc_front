
<div class="min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
  <div class="max-w-md w-full space-y-8 text-center">
    <div>
      <div class="mx-auto h-16 w-16 flex items-center justify-center rounded-full bg-blue-100">
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
      </div>
      <h2 class="mt-6 text-center text-2xl font-bold text-gray-900">
        인증 상태 확인 중...
      </h2>
      <p class="mt-2 text-center text-sm text-gray-600">
        잠시만 기다려주세요
      </p>
    </div>
  </div>
</div>

<script>
  // 페이지 로드 시 즉시 인증 상태 확인
  (function() {
    const token = localStorage.getItem('auth_token');
    
    if (!token) {
      // 토큰이 없으면 로그인 페이지로 리다이렉트
      window.location.href = '/login';
      return;
    }
    
    // 토큰이 있으면 유효성 검증
    fetch('http://localhost:7001/api/v1/auth/me', {
      method: 'GET',
      headers: {
        'Authorization': `Bearer ${token}`,
        'Content-Type': 'application/json'
      }
    })
    .then(response => {
      if (response.ok) {
        return response.json();
      } else {
        throw new Error('Token validation failed');
      }
    })
    .then(data => {
      if (data.status === 'success') {
        // 토큰이 유효하면 사용자 정보 업데이트 후 페이지 새로고침
        localStorage.setItem('user_info', JSON.stringify(data.user));
        window.location.reload();
      } else {
        throw new Error('Invalid token response');
      }
    })
    .catch(error => {
      // 토큰이 유효하지 않으면 제거하고 로그인 페이지로 리다이렉트
      localStorage.removeItem('auth_token');
      localStorage.removeItem('refresh_token');
      localStorage.removeItem('user_info');
      window.location.href = '/login';
    });
  })();
</script>