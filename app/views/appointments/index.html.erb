<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
  <!-- í˜ì´ì§€ í—¤ë” -->
  <div class="md:flex md:items-center md:justify-between">
    <div class="flex-1 min-w-0">
      <h2 class="text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate">
        ğŸ“… ì˜ˆì•½/ì ‘ìˆ˜ ê´€ë¦¬
      </h2>
      <p class="mt-1 text-sm text-gray-500">
        í™˜ì ì˜ˆì•½ ê´€ë¦¬, ì˜¨ë¼ì¸ ì˜ˆì•½ ìŠ¹ì¸ ë° ì ‘ìˆ˜ ì²˜ë¦¬
      </p>
    </div>
    <div class="mt-4 md:mt-0">
      <button onclick="showCreateAppointmentModal()" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm font-medium">
        ìƒˆ ì˜ˆì•½ ë“±ë¡
      </button>
    </div>
  </div>

  <!-- ì˜ˆì•½ í˜„í™© í†µê³„ -->
  <div class="mt-8">
    <div class="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-5 mb-6">
      <div class="bg-white overflow-hidden shadow rounded-lg">
        <div class="p-5">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                <span class="text-white text-sm">ğŸ“…</span>
              </div>
            </div>
            <div class="ml-5 w-0 flex-1">
              <dl>
                <dt class="text-sm font-medium text-gray-500 truncate">ì˜¤ëŠ˜ ì˜ˆì•½</dt>
                <dd class="text-lg font-medium text-gray-900" id="today-appointments-count">-</dd>
              </dl>
            </div>
          </div>
        </div>
      </div>
      
      <div class="bg-white overflow-hidden shadow rounded-lg">
        <div class="p-5">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center">
                <span class="text-white text-sm">â³</span>
              </div>
            </div>
            <div class="ml-5 w-0 flex-1">
              <dl>
                <dt class="text-sm font-medium text-gray-500 truncate">ëŒ€ê¸°ì¤‘</dt>
                <dd class="text-lg font-medium text-gray-900" id="pending-appointments-count">-</dd>
              </dl>
            </div>
          </div>
        </div>
      </div>
      
      <div class="bg-white overflow-hidden shadow rounded-lg">
        <div class="p-5">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                <span class="text-white text-sm">âœ…</span>
              </div>
            </div>
            <div class="ml-5 w-0 flex-1">
              <dl>
                <dt class="text-sm font-medium text-gray-500 truncate">í™•ì •</dt>
                <dd class="text-lg font-medium text-gray-900" id="confirmed-appointments-count">-</dd>
              </dl>
            </div>
          </div>
        </div>
      </div>
      
      <div class="bg-white overflow-hidden shadow rounded-lg">
        <div class="p-5">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center">
                <span class="text-white text-sm">ğŸ’»</span>
              </div>
            </div>
            <div class="ml-5 w-0 flex-1">
              <dl>
                <dt class="text-sm font-medium text-gray-500 truncate">ì˜¨ë¼ì¸ ì‹ ì²­</dt>
                <dd class="text-lg font-medium text-gray-900" id="online-appointments-count">-</dd>
              </dl>
            </div>
          </div>
        </div>
      </div>
      
      <div class="bg-white overflow-hidden shadow rounded-lg">
        <div class="p-5">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <div class="w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center">
                <span class="text-white text-sm">ğŸ“Š</span>
              </div>
            </div>
            <div class="ml-5 w-0 flex-1">
              <dl>
                <dt class="text-sm font-medium text-gray-500 truncate">ì´ë²ˆ ì£¼</dt>
                <dd class="text-lg font-medium text-gray-900" id="weekly-appointments-count">-</dd>
              </dl>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
    
  <!-- ì˜¨ë¼ì¸ ì˜ˆì•½ ëŒ€ê¸° ëª©ë¡ -->
  <div class="mb-8">
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-lg font-medium text-gray-900">ğŸŒ ì˜¨ë¼ì¸ ì˜ˆì•½ ì‹ ì²­ ëŒ€ê¸°</h3>
      <div class="flex items-center space-x-3">
        <select id="online-status-filter" class="border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm">
          <option value="pending">ëŒ€ê¸°ì¤‘ë§Œ</option>
          <option value="">ì „ì²´ ì˜¨ë¼ì¸</option>
        </select>
        <button onclick="refreshOnlineAppointments()" class="px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm">
          ìƒˆë¡œê³ ì¹¨
        </button>
      </div>
    </div>
    <div class="bg-white shadow overflow-hidden sm:rounded-md">
      <ul id="pending-online-appointments" class="divide-y divide-gray-200">
        <!-- ëŒ€ê¸°ì¤‘ì¸ ì˜¨ë¼ì¸ ì˜ˆì•½ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        <li class="px-6 py-4">
          <div class="flex items-center justify-between">
            <div class="flex-1">
              <div class="flex items-center justify-between">
                <p class="text-sm font-medium text-gray-900">ê¹€í™˜ì (45ì„¸)</p>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                  ì˜ˆì•½ ëŒ€ê¸°
                </span>
              </div>
              <div class="mt-1 flex items-center text-sm text-gray-500">
                <span class="mr-3">ğŸ“ 010-1234-5678</span>
                <span class="mr-3">ğŸ“… 2025ë…„ 01ì›” 15ì¼ 14:30</span>
                <span class="mr-3">ğŸ¥ ê±´ê°•ê²€ì§„</span>
                <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800 ml-2">ì˜¨ë¼ì¸</span>
              </div>
              <p class="mt-1 text-sm text-gray-600">ì •ê¸° ê±´ê°•ê²€ì§„ì„ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤. ë‹¹ë‡¨ ê°€ì¡±ë ¥ì´ ìˆì–´ì„œ í˜ˆë‹¹ ê²€ì‚¬ í¬í•¨í•´ì„œ ì¢…í•©ì ìœ¼ë¡œ ê²€ì‚¬ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤.</p>
              <div class="mt-2 text-xs text-gray-400">
                ì‹ ì²­ì¼ì‹œ: 2025ë…„ 01ì›” 11ì¼ 09:15
              </div>
            </div>
            <div class="ml-4 flex flex-col space-y-2">
              <button onclick="showOnlineAppointmentActions(1)" class="px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700">
                ìŠ¹ì¸
              </button>
              <button onclick="viewOnlineAppointmentDetail(1)" class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700">
                ìƒì„¸
              </button>
              <button onclick="rejectOnlineAppointment(1)" class="px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700">
                ê±°ë¶€
              </button>
            </div>
          </div>
        </li>
        
        <li class="px-6 py-4 hover:bg-gray-50">
          <div class="flex items-center justify-between">
            <div class="flex-1">
              <div class="flex items-center justify-between">
                <p class="text-sm font-medium text-gray-900">ì´í™˜ì (32ì„¸)</p>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                  ì˜ˆì•½ ëŒ€ê¸°
                </span>
              </div>
              <div class="mt-1 flex items-center text-sm text-gray-500">
                <span class="mr-3">ğŸ“ 010-9876-5432</span>
                <span class="mr-3">ğŸ“… 2025ë…„ 01ì›” 16ì¼ 10:00</span>
                <span class="mr-3">ğŸ¥ ì§„ë£Œ ìƒë‹´</span>
                <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800 ml-2">ì˜¨ë¼ì¸</span>
              </div>
              <p class="mt-1 text-sm text-gray-600">ìµœê·¼ ë³µí†µì´ ì§€ì†ë˜ê³  ìˆìŠµë‹ˆë‹¤. ì†Œí™”ë¶ˆëŸ‰ì¸ ê²ƒ ê°™ì€ë° ì •í™•í•œ ì§„ë‹¨ì„ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤.</p>
              <div class="mt-2 text-xs text-gray-400">
                ì‹ ì²­ì¼ì‹œ: 2025ë…„ 01ì›” 11ì¼ 14:22
              </div>
            </div>
            <div class="ml-4 flex flex-col space-y-2">
              <button onclick="showOnlineAppointmentActions(2)" class="px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700">
                ìŠ¹ì¸
              </button>
              <button onclick="viewOnlineAppointmentDetail(2)" class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700">
                ìƒì„¸
              </button>
              <button onclick="rejectOnlineAppointment(2)" class="px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700">
                ê±°ë¶€
              </button>
            </div>
          </div>
        </li>
        
        <li class="px-6 py-4 hover:bg-gray-50">
          <div class="flex items-center justify-between">
            <div class="flex-1">
              <div class="flex items-center justify-between">
                <p class="text-sm font-medium text-gray-900">ë°•í™˜ì (28ì„¸)</p>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                  ì˜ˆì•½ ëŒ€ê¸°
                </span>
              </div>
              <div class="mt-1 flex items-center text-sm text-gray-500">
                <span class="mr-3">ğŸ“ 010-1111-2222</span>
                <span class="mr-3">ğŸ“… 2025ë…„ 01ì›” 17ì¼ 16:00</span>
                <span class="mr-3">ğŸ¥ ì˜ˆë°©ì ‘ì¢…</span>
                <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800 ml-2">ì˜¨ë¼ì¸</span>
              </div>
              <p class="mt-1 text-sm text-gray-600">í•´ì™¸ì—¬í–‰ ì˜ˆì •ì´ë¼ Aí˜• ê°„ì—¼ ì˜ˆë°©ì ‘ì¢…ì„ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ í•„ìˆ˜ ì˜ˆë°©ì ‘ì¢…ë„ í•¨ê»˜ ìƒë‹´ ë°›ì„ ìˆ˜ ìˆë‚˜ìš”?</p>
              <div class="mt-2 text-xs text-gray-400">
                ì‹ ì²­ì¼ì‹œ: 2025ë…„ 01ì›” 11ì¼ 16:45
              </div>
            </div>
            <div class="ml-4 flex flex-col space-y-2">
              <button onclick="showOnlineAppointmentActions(3)" class="px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700">
                ìŠ¹ì¸
              </button>
              <button onclick="viewOnlineAppointmentDetail(3)" class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700">
                ìƒì„¸
              </button>
              <button onclick="rejectOnlineAppointment(3)" class="px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700">
                ê±°ë¶€
              </button>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </div>
  
  <!-- ë·° ì „í™˜ íƒ­ -->
  <div class="mb-6">
    <div class="sm:hidden">
      <select id="view-tab-select" class="block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500">
        <option value="list">ì˜ˆì•½ ëª©ë¡</option>
        <option value="calendar">ì˜ˆì•½ ìº˜ë¦°ë”</option>
      </select>
    </div>
    <div class="hidden sm:block">
      <nav class="flex space-x-8" aria-label="Tabs">
        <button id="list-view-tab" onclick="switchView('list')" class="view-tab-active whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm">
          ğŸ“‹ ì˜ˆì•½ ëª©ë¡
        </button>
        <button id="calendar-view-tab" onclick="switchView('calendar')" class="view-tab-inactive whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm">
          ğŸ“… ì˜ˆì•½ ìº˜ë¦°ë”
        </button>
      </nav>
    </div>
  </div>

  <!-- ì˜ˆì•½ ëª©ë¡ ë·° -->
  <div id="list-view" class="bg-white shadow sm:rounded-md">
    <div class="px-6 py-4 border-b border-gray-200">
      <div class="flex items-center justify-between">
        <h3 class="text-lg font-medium text-gray-900">ì „ì²´ ì˜ˆì•½ ëª©ë¡</h3>
        <div class="flex space-x-3">
          <select id="appointment-status-filter" class="border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm">
            <option value="">ì „ì²´ ìƒíƒœ</option>
            <option value="pending">ëŒ€ê¸°ì¤‘</option>
            <option value="confirmed">í™•ì •</option>
            <option value="arrived">ë‚´ì›</option>
            <option value="completed">ì™„ë£Œ</option>
            <option value="cancelled">ì·¨ì†Œ</option>
          </select>
          <select id="appointment-department-filter" class="border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm">
            <option value="">ì „ì²´ ë¶€ì„œ</option>
            <option value="ì˜ë£Œì§„">ì˜ë£Œì§„</option>
            <option value="ê°„í˜¸ë¶€">ê°„í˜¸ë¶€</option>
            <option value="í–‰ì •ë¶€">í–‰ì •ë¶€</option>
          </select>
          <input type="date" id="appointment-date-filter" class="border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm">
          <button onclick="filterAppointments()" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm">
            ê²€ìƒ‰
          </button>
        </div>
      </div>
    </div>
    
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">í™˜ì ì •ë³´</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì˜ˆì•½ ì¼ì‹œ</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ìœ í˜•</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ë‹´ë‹¹ì˜</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì£¼ì¦ìƒ</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ìƒíƒœ</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì‘ì—…</th>
          </tr>
        </thead>
        <tbody id="appointments-table-body" class="bg-white divide-y divide-gray-200">
          <!-- ì˜ˆì•½ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- ìº˜ë¦°ë” ë·° -->
  <div id="calendar-view" class="bg-white shadow sm:rounded-md hidden">
    <div class="px-6 py-4 border-b border-gray-200">
      <div class="flex items-center justify-between">
        <h3 class="text-lg font-medium text-gray-900">ì˜ˆì•½ ìº˜ë¦°ë”</h3>
        <div class="flex items-center space-x-4">
          <div class="flex items-center space-x-2">
            <button onclick="navigateCalendar('prev')" class="p-2 text-gray-600 hover:text-gray-900">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
              </svg>
            </button>
            <h4 id="calendar-month-year" class="text-lg font-medium text-gray-900 min-w-32 text-center"></h4>
            <button onclick="navigateCalendar('next')" class="p-2 text-gray-600 hover:text-gray-900">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </button>
          </div>
          <button onclick="goToToday()" class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700">
            ì˜¤ëŠ˜
          </button>
          <select id="calendar-department-filter" class="border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm">
            <option value="">ì „ì²´ ë¶€ì„œ</option>
            <option value="ì˜ë£Œì§„">ì˜ë£Œì§„</option>
            <option value="ê°„í˜¸ë¶€">ê°„í˜¸ë¶€</option>
            <option value="í–‰ì •ë¶€">í–‰ì •ë¶€</option>
          </select>
        </div>
      </div>
    </div>
    
    <div class="p-6">
      <!-- ìº˜ë¦°ë” ê·¸ë¦¬ë“œ -->
      <div class="grid grid-cols-7 gap-px bg-gray-200 rounded-lg overflow-hidden">
        <!-- ìš”ì¼ í—¤ë” -->
        <div class="bg-gray-50 p-2 text-center text-xs font-medium text-gray-500">ì¼</div>
        <div class="bg-gray-50 p-2 text-center text-xs font-medium text-gray-500">ì›”</div>
        <div class="bg-gray-50 p-2 text-center text-xs font-medium text-gray-500">í™”</div>
        <div class="bg-gray-50 p-2 text-center text-xs font-medium text-gray-500">ìˆ˜</div>
        <div class="bg-gray-50 p-2 text-center text-xs font-medium text-gray-500">ëª©</div>
        <div class="bg-gray-50 p-2 text-center text-xs font-medium text-gray-500">ê¸ˆ</div>
        <div class="bg-gray-50 p-2 text-center text-xs font-medium text-gray-500">í† </div>
        
        <!-- ìº˜ë¦°ë” ë‚ ì§œ ì…€ë“¤ -->
        <div id="calendar-grid" class="contents">
          <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
        </div>
      </div>
      
      <!-- ì„ íƒëœ ë‚ ì§œì˜ ì˜ˆì•½ ëª©ë¡ -->
      <div id="selected-date-appointments" class="mt-6 hidden">
        <h4 class="text-md font-medium text-gray-900 mb-4">
          <span id="selected-date-text"></span> ì˜ˆì•½ ëª©ë¡
        </h4>
        <div class="bg-gray-50 rounded-lg">
          <div id="selected-date-appointments-list" class="divide-y divide-gray-200">
            <!-- ì„ íƒëœ ë‚ ì§œì˜ ì˜ˆì•½ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ìƒˆ ì˜ˆì•½ ë“±ë¡ ëª¨ë‹¬ -->
<div id="appointment-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
  <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
    <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
      <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
        <h3 class="text-lg font-medium text-gray-900 mb-4">ìƒˆ ì˜ˆì•½ ë“±ë¡</h3>
        <form id="appointment-form">
          <div class="space-y-4">
            <div>
              <label for="patient-search" class="block text-sm font-medium text-gray-700">í™˜ì ê²€ìƒ‰</label>
              <input type="text" id="patient-search" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm" placeholder="í™˜ìëª… ë˜ëŠ” ì „í™”ë²ˆí˜¸ ì…ë ¥">
              <div id="patient-search-results" class="mt-2 max-h-32 overflow-y-auto"></div>
              <input type="hidden" id="selected-patient-id">
            </div>
            
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label for="appointment-date" class="block text-sm font-medium text-gray-700">ì˜ˆì•½ ë‚ ì§œ</label>
                <input type="date" id="appointment-date" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
              </div>
              <div>
                <label for="appointment-time" class="block text-sm font-medium text-gray-700">ì˜ˆì•½ ì‹œê°„</label>
                <input type="time" id="appointment-time" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
              </div>
            </div>
            
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label for="appointment-type" class="block text-sm font-medium text-gray-700">ì˜ˆì•½ ìœ í˜•</label>
                <select id="appointment-type" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                  <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                  <option value="consultation">ì§„ë£Œ ìƒë‹´</option>
                  <option value="checkup">ê±´ê°•ê²€ì§„</option>
                  <option value="treatment">ì¹˜ë£Œ</option>
                  <option value="emergency">ì‘ê¸‰ì§„ë£Œ</option>
                  <option value="follow_up">ì¬ì§„</option>
                  <option value="vaccination">ì˜ˆë°©ì ‘ì¢…</option>
                  <option value="procedure">ì²˜ì¹˜</option>
                </select>
              </div>
              <div>
                <label for="appointment-department" class="block text-sm font-medium text-gray-700">ë¶€ì„œ</label>
                <select id="appointment-department" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                  <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                  <option value="ì˜ë£Œì§„">ì˜ë£Œì§„</option>
                  <option value="ê°„í˜¸ë¶€">ê°„í˜¸ë¶€</option>
                  <option value="í–‰ì •ë¶€">í–‰ì •ë¶€</option>
                </select>
              </div>
            </div>
            
            <div>
              <label for="doctor-select" class="block text-sm font-medium text-gray-700">ë‹´ë‹¹ì˜ (ì„ íƒ)</label>
              <select id="doctor-select" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                <option value="">ë‹´ë‹¹ì˜ ì„ íƒ</option>
              </select>
            </div>
            
            <div>
              <label for="chief-complaint" class="block text-sm font-medium text-gray-700">ì£¼ì¦ìƒ</label>
              <textarea id="chief-complaint" rows="3" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm" placeholder="í™˜ìì˜ ì£¼ì¦ìƒì„ ìƒì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš” (ìµœì†Œ 5ê¸€ì)"></textarea>
            </div>
          </div>
          
          <div class="flex items-center justify-end pt-4 space-x-3">
            <button type="button" onclick="closeAppointmentModal()" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
              ì·¨ì†Œ
            </button>
            <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">
              ì˜ˆì•½ ë“±ë¡
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- ì˜¨ë¼ì¸ ì˜ˆì•½ ìŠ¹ì¸ ëª¨ë‹¬ -->
<div id="online-appointment-approval-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
  <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
    <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
      <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-medium text-gray-900">ì˜¨ë¼ì¸ ì˜ˆì•½ ìŠ¹ì¸</h3>
          <button onclick="closeOnlineApprovalModal()" class="text-gray-400 hover:text-gray-500">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        
        <form id="online-approval-form">
          <div class="space-y-4">
            <div class="bg-gray-50 p-4 rounded-lg">
              <h4 class="text-sm font-medium text-gray-900 mb-2">í™˜ì ì •ë³´</h4>
              <div id="online-patient-info" class="text-sm text-gray-600">
                <!-- í™˜ì ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
              </div>
            </div>
            
            <div class="bg-blue-50 p-4 rounded-lg">
              <h4 class="text-sm font-medium text-gray-900 mb-2">ì˜ˆì•½ ì‹ ì²­ ë‚´ìš©</h4>
              <div id="online-appointment-info" class="text-sm text-gray-600">
                <!-- ì˜ˆì•½ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
              </div>
            </div>
            
            <div>
              <label for="assigned-doctor" class="block text-sm font-medium text-gray-700">ë‹´ë‹¹ì˜ ë°°ì •</label>
              <select id="assigned-doctor" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                <option value="">ë‹´ë‹¹ì˜ ì„ íƒ</option>
                <option value="1">ê¹€ì˜ì‚¬ (ë‚´ê³¼ ì „ë¬¸ì˜)</option>
                <option value="2">ì´ì˜ì‚¬ (ê°€ì •ì˜í•™ê³¼ ì „ë¬¸ì˜)</option>
                <option value="3">ë°•ì˜ì‚¬ (ì™¸ê³¼ ì „ë¬¸ì˜)</option>
              </select>
            </div>
            
            <div>
              <label for="appointment-notes" class="block text-sm font-medium text-gray-700">ìŠ¹ì¸ ë©”ëª¨</label>
              <textarea id="appointment-notes" rows="3" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm" placeholder="í™˜ìì—ê²Œ ì „ë‹¬í•  ë©”ì‹œì§€ë‚˜ ì£¼ì˜ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)"></textarea>
            </div>
          </div>
          
          <div class="flex items-center justify-end pt-6 space-x-3">
            <button type="button" onclick="closeOnlineApprovalModal()" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
              ì·¨ì†Œ
            </button>
            <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700">
              ìŠ¹ì¸ ë° ì˜ˆì•½ í™•ì •
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- ì˜¨ë¼ì¸ ì˜ˆì•½ ê±°ë¶€ ëª¨ë‹¬ -->
<div id="online-appointment-rejection-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
  <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
    <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
      <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-medium text-gray-900">ì˜¨ë¼ì¸ ì˜ˆì•½ ê±°ë¶€</h3>
          <button onclick="closeOnlineRejectionModal()" class="text-gray-400 hover:text-gray-500">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        
        <form id="online-rejection-form">
          <div class="space-y-4">
            <div class="bg-gray-50 p-4 rounded-lg">
              <h4 class="text-sm font-medium text-gray-900 mb-2">ì˜ˆì•½ ì‹ ì²­ ì •ë³´</h4>
              <div id="rejection-appointment-info" class="text-sm text-gray-600">
                <!-- ì˜ˆì•½ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
              </div>
            </div>
            
            <div>
              <label for="rejection-reason" class="block text-sm font-medium text-gray-700">ê±°ë¶€ ì‚¬ìœ  <span class="text-red-500">*</span></label>
              <select id="rejection-reason" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm">
                <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                <option value="schedule_full">í•´ë‹¹ ì‹œê°„ëŒ€ ì˜ˆì•½ ë§ˆê°</option>
                <option value="doctor_unavailable">ë‹´ë‹¹ì˜ ë¶€ì¬</option>
                <option value="insufficient_info">ì •ë³´ ë¶€ì¡±</option>
                <option value="duplicate_booking">ì¤‘ë³µ ì˜ˆì•½</option>
                <option value="system_maintenance">ì‹œìŠ¤í…œ ì ê²€</option>
                <option value="other">ê¸°íƒ€ ì‚¬ìœ </option>
              </select>
            </div>
            
            <div>
              <label for="rejection-message" class="block text-sm font-medium text-gray-700">í™˜ì ì „ë‹¬ ë©”ì‹œì§€</label>
              <textarea id="rejection-message" rows="4" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm" placeholder="í™˜ìì—ê²Œ ì „ë‹¬í•  ê±°ë¶€ ì‚¬ìœ ì™€ ëŒ€ì•ˆì„ ì•ˆë‚´í•´ì£¼ì„¸ìš”"></textarea>
            </div>
          </div>
          
          <div class="flex items-center justify-end pt-6 space-x-3">
            <button type="button" onclick="closeOnlineRejectionModal()" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
              ì·¨ì†Œ
            </button>
            <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700">
              ê±°ë¶€ ì²˜ë¦¬
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- ì˜ˆì•½ ìƒì„¸ ëª¨ë‹¬ -->
<div id="appointment-detail-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
  <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
    <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full">
      <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-medium text-gray-900">ì˜ˆì•½ ìƒì„¸ ì •ë³´</h3>
          <button onclick="closeAppointmentDetailModal()" class="text-gray-400 hover:text-gray-500">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        <div id="appointment-detail-content">
          <!-- ì˜ˆì•½ ìƒì„¸ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>
      </div>
    </div>
  </div>
</div>

<style>
/* íƒ­ ìŠ¤íƒ€ì¼ */
.view-tab-active {
  border-color: #3B82F6;
  color: #3B82F6;
}

.view-tab-inactive {
  border-color: transparent;
  color: #6B7280;
}

.view-tab-inactive:hover {
  color: #374151;
  border-color: #D1D5DB;
}

/* ìº˜ë¦°ë” ì…€ ìŠ¤íƒ€ì¼ */
.calendar-cell {
  min-height: 120px;
  background-color: white;
  padding: 8px;
  border: 1px solid transparent;
  cursor: pointer;
  transition: all 0.2s;
}

.calendar-cell:hover {
  background-color: #F3F4F6;
  border-color: #D1D5DB;
}

.calendar-cell.selected {
  background-color: #DBEAFE;
  border-color: #3B82F6;
}

.calendar-cell.other-month {
  color: #9CA3AF;
  background-color: #F9FAFB;
}

.calendar-cell.today {
  background-color: #FEF3C7;
  border-color: #F59E0B;
}

.calendar-cell.has-appointments {
  border-left: 4px solid #3B82F6;
}

/* ì˜ˆì•½ ì´ë²¤íŠ¸ ìŠ¤íƒ€ì¼ */
.appointment-event {
  font-size: 0.75rem;
  padding: 2px 6px;
  margin: 1px 0;
  border-radius: 4px;
  cursor: pointer;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.appointment-event.pending {
  background-color: #FEF3C7;
  color: #92400E;
}

.appointment-event.confirmed {
  background-color: #DBEAFE;
  color: #1E40AF;
}

.appointment-event.arrived {
  background-color: #E0E7FF;
  color: #5B21B6;
}

.appointment-event.completed {
  background-color: #D1FAE5;
  color: #065F46;
}

.appointment-event.cancelled {
  background-color: #F3F4F6;
  color: #6B7280;
  text-decoration: line-through;
}

.appointment-event:hover {
  opacity: 0.8;
  transform: scale(1.02);
}
</style>

<script>
// ì „ì—­ ë³€ìˆ˜
let currentCalendarDate = new Date();
let calendarAppointments = [];
let selectedCalendarDate = null;

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
document.addEventListener('DOMContentLoaded', async () => {
  try {
    await loadAppointmentDashboard();
    await loadAppointments();
    initializePatientSearch();
    loadDoctorsList();
    initializeCalendar();
    setupViewSwitching();
  } catch (error) {
    console.error('ì˜ˆì•½ ê´€ë¦¬ ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
    toast.error('ì˜ˆì•½ ê´€ë¦¬ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
  }
});

// ì˜ˆì•½ ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
async function loadAppointmentDashboard() {
  try {
    const response = await api.get('/appointments/dashboard');
    
    if (response.data.status === 'success') {
      const { statistics, today_appointments, pending_appointments } = response.data.data;
      
      // í†µê³„ ì—…ë°ì´íŠ¸
      document.getElementById('today-appointments-count').textContent = statistics.today.total;
      document.getElementById('pending-appointments-count').textContent = statistics.today.pending;
      document.getElementById('confirmed-appointments-count').textContent = statistics.today.confirmed;
      document.getElementById('online-appointments-count').textContent = statistics.pending_online;
      document.getElementById('weekly-appointments-count').textContent = statistics.upcoming_week;
      
      // ì˜¨ë¼ì¸ ì˜ˆì•½ ëŒ€ê¸° ëª©ë¡ í‘œì‹œ
      displayPendingOnlineAppointments(pending_appointments);
    }
  } catch (error) {
    console.error('ì˜ˆì•½ ëŒ€ì‹œë³´ë“œ ë¡œë“œ ì˜¤ë¥˜:', error);
  }
}

// ì˜¨ë¼ì¸ ì˜ˆì•½ ëŒ€ê¸° ëª©ë¡ í‘œì‹œ
function displayPendingOnlineAppointments(appointments) {
  const container = document.getElementById('pending-online-appointments');
  
  if (!appointments || appointments.length === 0) {
    container.innerHTML = '<li class="px-6 py-4 text-center text-gray-500">ëŒ€ê¸°ì¤‘ì¸ ì˜¨ë¼ì¸ ì˜ˆì•½ì´ ì—†ìŠµë‹ˆë‹¤.</li>';
    return;
  }
  
  const html = appointments.map(appointment => `
    <li class="px-6 py-4 hover:bg-gray-50">
      <div class="flex items-center justify-between">
        <div class="flex-1">
          <div class="flex items-center justify-between">
            <p class="text-sm font-medium text-gray-900">${appointment.patient_name} (${appointment.patient_age}ì„¸)</p>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${appointment.status_color}">
              ${appointment.status_text}
            </span>
          </div>
          <div class="mt-1 flex items-center text-sm text-gray-500">
            <span class="mr-3">ğŸ“ ${appointment.patient_phone}</span>
            <span class="mr-3">ğŸ“… ${appointment.formatted_appointment_date}</span>
            <span class="mr-3">ğŸ¥ ${appointment.appointment_type_text}</span>
          </div>
          <p class="mt-1 text-sm text-gray-600">${appointment.chief_complaint}</p>
        </div>
        <div class="ml-4 flex space-x-2">
          <button onclick="confirmAppointment(${appointment.id})" class="px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700">
            í™•ì •
          </button>
          <button onclick="viewAppointmentDetail(${appointment.id})" class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700">
            ìƒì„¸
          </button>
        </div>
      </div>
    </li>
  `).join('');
  
  container.innerHTML = html;
}

// ì˜ˆì•½ ëª©ë¡ ë¡œë“œ
async function loadAppointments(filters = {}) {
  try {
    const params = new URLSearchParams();
    
    if (filters.status) params.append('status', filters.status);
    if (filters.department) params.append('department', filters.department);
    if (filters.date) params.append('date', filters.date);
    
    const response = await api.get(`/appointments?${params.toString()}`);
    
    if (response.data.status === 'success') {
      displayAppointments(response.data.data.appointments);
    }
  } catch (error) {
    console.error('ì˜ˆì•½ ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
    toast.error('ì˜ˆì•½ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
  }
}

// ì˜ˆì•½ ëª©ë¡ í‘œì‹œ (ìƒ˜í”Œ ë°ì´í„° í¬í•¨)
function displayAppointments(appointments) {
  const tbody = document.getElementById('appointments-table-body');
  
  // ìƒ˜í”Œ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ìƒì„±
  if (!appointments || appointments.length === 0) {
    appointments = generateSampleListAppointments();
  }
  
  const html = appointments.map(appointment => `
    <tr class="hover:bg-gray-50 cursor-pointer" ondblclick="viewAppointmentDetail(${appointment.id})">
      <td class="px-6 py-4 whitespace-nowrap">
        <div class="flex items-center">
          <div class="flex-shrink-0 h-10 w-10">
            <div class="h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center">
              <span class="text-sm font-medium text-gray-700">${appointment.patient_name.charAt(0)}</span>
            </div>
          </div>
          <div class="ml-4">
            <div class="text-sm font-medium text-gray-900">${appointment.patient_name}</div>
            <div class="text-sm text-gray-500">${appointment.patient_age}ì„¸ Â· ${appointment.patient_gender} Â· ğŸ“ ${appointment.patient_phone}</div>
            ${appointment.created_by_patient ? '<span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800 mt-1">ì˜¨ë¼ì¸ ì‹ ì²­</span>' : ''}
          </div>
        </div>
      </td>
      <td class="px-6 py-4 whitespace-nowrap">
        <div class="text-sm text-gray-900">${appointment.formatted_appointment_date}</div>
        <div class="text-sm text-gray-500">${appointment.time_until_appointment || 'ì‹œê°„ ê²½ê³¼'}</div>
        ${appointment.is_urgent ? '<span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800 mt-1">ê¸´ê¸‰</span>' : ''}
      </td>
      <td class="px-6 py-4 whitespace-nowrap">
        <div class="text-sm text-gray-900">${appointment.appointment_type_text}</div>
        <div class="text-sm text-gray-500">${appointment.department}</div>
        ${appointment.insurance_type ? `<div class="text-xs text-gray-400 mt-1">${appointment.insurance_type}</div>` : ''}
      </td>
      <td class="px-6 py-4 whitespace-nowrap">
        <div class="text-sm text-gray-900">${appointment.doctor_name || 'ë¯¸ë°°ì •'}</div>
        ${appointment.doctor_name ? `<div class="text-sm text-gray-500">${appointment.doctor_specialty || 'ì „ë¬¸ì˜'}</div>` : ''}
      </td>
      <td class="px-6 py-4 max-w-xs">
        <div class="text-sm text-gray-900 truncate" title="${appointment.chief_complaint}">
          ${appointment.chief_complaint}
        </div>
        ${appointment.medical_history ? `<div class="text-xs text-gray-500 truncate mt-1" title="${appointment.medical_history}">ê³¼ê±°ë ¥: ${appointment.medical_history}</div>` : ''}
      </td>
      <td class="px-6 py-4 whitespace-nowrap">
        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${appointment.status_color}">
          ${appointment.status_text}
        </span>
        ${appointment.last_updated ? `<div class="text-xs text-gray-400 mt-1">${appointment.last_updated}</div>` : ''}
      </td>
      <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
        <div class="flex flex-col space-y-1">
          <div class="flex space-x-2">
            ${appointment.can_confirm ? `<button onclick="event.stopPropagation(); confirmAppointment(${appointment.id})" class="text-green-600 hover:text-green-900 text-xs">í™•ì •</button>` : ''}
            ${appointment.can_cancel ? `<button onclick="event.stopPropagation(); cancelAppointment(${appointment.id})" class="text-red-600 hover:text-red-900 text-xs">ì·¨ì†Œ</button>` : ''}
            ${appointment.can_arrive ? `<button onclick="event.stopPropagation(); arriveAppointment(${appointment.id})" class="text-blue-600 hover:text-blue-900 text-xs">ë‚´ì›</button>` : ''}
          </div>
          <button onclick="event.stopPropagation(); viewAppointmentDetail(${appointment.id})" class="text-indigo-600 hover:text-indigo-900 text-xs">ìƒì„¸ë³´ê¸°</button>
        </div>
      </td>
    </tr>
  `).join('');
  
  tbody.innerHTML = html;
}

// ì˜ˆì•½ ëª©ë¡ìš© ìƒ˜í”Œ ë°ì´í„° ìƒì„±
function generateSampleListAppointments() {
  const sampleAppointments = [
    {
      id: 'list-1',
      patient_name: 'ê¹€í™˜ì',
      patient_age: 45,
      patient_gender: 'ë‚¨ì„±',
      patient_phone: '010-1234-5678',
      appointment_date: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString(),
      formatted_appointment_date: '2025ë…„ 01ì›” 13ì¼ 14:30',
      formatted_appointment_time: '14:30',
      appointment_type_text: 'ê±´ê°•ê²€ì§„',
      department: 'ì˜ë£Œì§„',
      doctor_name: 'ì´ë‚´ê³¼',
      doctor_specialty: 'ë‚´ê³¼ ì „ë¬¸ì˜',
      chief_complaint: 'ì •ê¸° ê±´ê°•ê²€ì§„ì„ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤. ë‹¹ë‡¨ ê°€ì¡±ë ¥ì´ ìˆì–´ì„œ í˜ˆë‹¹ ê²€ì‚¬ í¬í•¨í•´ì„œ ì¢…í•©ì ìœ¼ë¡œ ê²€ì‚¬ ë°›ê³  ì‹¶ì–´ìš”.',
      medical_history: 'ê³ í˜ˆì••, ë‹¹ë‡¨ ê°€ì¡±ë ¥',
      insurance_type: 'ê±´ê°•ë³´í—˜',
      status: 'confirmed',
      status_text: 'ì˜ˆì•½ í™•ì •',
      status_color: 'bg-blue-100 text-blue-800',
      created_by_patient: false,
      is_urgent: false,
      time_until_appointment: '2ì¼ í›„',
      last_updated: '1ì‹œê°„ ì „',
      can_confirm: false,
      can_cancel: true,
      can_arrive: false
    },
    {
      id: 'list-2',
      patient_name: 'ë°•í™˜ì',
      patient_age: 32,
      patient_gender: 'ì—¬ì„±',
      patient_phone: '010-9876-5432',
      appointment_date: new Date(Date.now() + 1 * 24 * 60 * 60 * 1000).toISOString(),
      formatted_appointment_date: '2025ë…„ 01ì›” 12ì¼ 10:00',
      formatted_appointment_time: '10:00',
      appointment_type_text: 'ì§„ë£Œ ìƒë‹´',
      department: 'ì˜ë£Œì§„',
      doctor_name: 'ê¹€ê°€ì •ì˜í•™',
      doctor_specialty: 'ê°€ì •ì˜í•™ê³¼ ì „ë¬¸ì˜',
      chief_complaint: 'ìµœê·¼ ë³µí†µì´ ì§€ì†ë˜ê³  ìˆìŠµë‹ˆë‹¤. ì†Œí™”ë¶ˆëŸ‰ì¸ ê²ƒ ê°™ì€ë° ì •í™•í•œ ì§„ë‹¨ì„ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤.',
      medical_history: 'ìœ„ì—¼',
      insurance_type: 'ì˜ë£Œê¸‰ì—¬',
      status: 'pending',
      status_text: 'ì˜ˆì•½ ëŒ€ê¸°',
      status_color: 'bg-yellow-100 text-yellow-800',
      created_by_patient: true,
      is_urgent: false,
      time_until_appointment: 'ë‚´ì¼',
      last_updated: '2ì‹œê°„ ì „',
      can_confirm: true,
      can_cancel: true,
      can_arrive: false
    },
    {
      id: 'list-3',
      patient_name: 'ìµœí™˜ì',
      patient_age: 28,
      patient_gender: 'ë‚¨ì„±',
      patient_phone: '010-1111-2222',
      appointment_date: new Date(Date.now() + 3 * 60 * 60 * 1000).toISOString(),
      formatted_appointment_date: '2025ë…„ 01ì›” 11ì¼ 16:30',
      formatted_appointment_time: '16:30',
      appointment_type_text: 'ì‘ê¸‰ì§„ë£Œ',
      department: 'ì˜ë£Œì§„',
      doctor_name: 'ì‘ê¸‰ì˜ë£Œì§„',
      doctor_specialty: 'ì‘ê¸‰ì˜í•™ê³¼',
      chief_complaint: 'ê°‘ì‘ìŠ¤ëŸ° í‰í†µê³¼ í˜¸í¡ê³¤ë€ ì¦ìƒì´ ìˆìŠµë‹ˆë‹¤. ì‘ê¸‰ì§„ë£Œê°€ í•„ìš”í•©ë‹ˆë‹¤.',
      medical_history: 'ì—†ìŒ',
      insurance_type: 'ê±´ê°•ë³´í—˜',
      status: 'arrived',
      status_text: 'ë‚´ì› ì™„ë£Œ',
      status_color: 'bg-purple-100 text-purple-800',
      created_by_patient: false,
      is_urgent: true,
      time_until_appointment: 'ì§„í–‰ì¤‘',
      last_updated: '30ë¶„ ì „',
      can_confirm: false,
      can_cancel: false,
      can_arrive: false
    },
    {
      id: 'list-4',
      patient_name: 'ì •í™˜ì',
      patient_age: 65,
      patient_gender: 'ì—¬ì„±',
      patient_phone: '010-3333-4444',
      appointment_date: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),
      formatted_appointment_date: '2025ë…„ 01ì›” 11ì¼ 13:00',
      formatted_appointment_time: '13:00',
      appointment_type_text: 'ì¬ì§„',
      department: 'ì˜ë£Œì§„',
      doctor_name: 'ë°•ìˆœí™˜ê¸°',
      doctor_specialty: 'ìˆœí™˜ê¸°ë‚´ê³¼ ì „ë¬¸ì˜',
      chief_complaint: 'ê³ í˜ˆì•• ì•½ë¬¼ ì¡°ì • ë° ê²½ê³¼ ê´€ì°°ì„ ìœ„í•œ ì¬ì§„ì…ë‹ˆë‹¤.',
      medical_history: 'ê³ í˜ˆì••, ë‹¹ë‡¨, ê³ ì§€í˜ˆì¦',
      insurance_type: 'ê±´ê°•ë³´í—˜',
      status: 'completed',
      status_text: 'ì§„ë£Œ ì™„ë£Œ',
      status_color: 'bg-green-100 text-green-800',
      created_by_patient: false,
      is_urgent: false,
      time_until_appointment: 'ì™„ë£Œ',
      last_updated: '2ì‹œê°„ ì „',
      can_confirm: false,
      can_cancel: false,
      can_arrive: false
    },
    {
      id: 'list-5',
      patient_name: 'ê°•í™˜ì',
      patient_age: 24,
      patient_gender: 'ë‚¨ì„±',
      patient_phone: '010-5555-6666',
      appointment_date: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(),
      formatted_appointment_date: '2025ë…„ 01ì›” 18ì¼ 11:00',
      formatted_appointment_time: '11:00',
      appointment_type_text: 'ì˜ˆë°©ì ‘ì¢…',
      department: 'ê°„í˜¸ë¶€',
      doctor_name: 'ê°„í˜¸íŒ€ì¥',
      doctor_specialty: 'ì˜ˆë°©ì ‘ì¢… ë‹´ë‹¹',
      chief_complaint: 'í•´ì™¸ì—¬í–‰ ì˜ˆì •ì´ë¼ Aí˜• ê°„ì—¼ ì˜ˆë°©ì ‘ì¢…ì„ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ í•„ìˆ˜ ì˜ˆë°©ì ‘ì¢…ë„ í•¨ê»˜ ìƒë‹´ ë°›ì„ ìˆ˜ ìˆë‚˜ìš”?',
      medical_history: 'ì•Œë ˆë¥´ê¸° ì—†ìŒ',
      insurance_type: 'ê±´ê°•ë³´í—˜',
      status: 'pending',
      status_text: 'ì˜ˆì•½ ëŒ€ê¸°',
      status_color: 'bg-yellow-100 text-yellow-800',
      created_by_patient: true,
      is_urgent: false,
      time_until_appointment: '7ì¼ í›„',
      last_updated: '5ì‹œê°„ ì „',
      can_confirm: true,
      can_cancel: true,
      can_arrive: false
    }
  ];
  
  return sampleAppointments;
}

// ì˜ˆì•½ í•„í„°ë§
function filterAppointments() {
  const filters = {
    status: document.getElementById('appointment-status-filter').value,
    department: document.getElementById('appointment-department-filter').value,
    date: document.getElementById('appointment-date-filter').value
  };
  
  loadAppointments(filters);
}

// ìƒˆ ì˜ˆì•½ ë“±ë¡ ëª¨ë‹¬ í‘œì‹œ
function showCreateAppointmentModal() {
  document.getElementById('appointment-modal').classList.remove('hidden');
  // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
  document.getElementById('appointment-date').value = new Date().toISOString().split('T')[0];
}

// ìƒˆ ì˜ˆì•½ ë“±ë¡ ëª¨ë‹¬ ë‹«ê¸°
function closeAppointmentModal() {
  document.getElementById('appointment-modal').classList.add('hidden');
  document.getElementById('appointment-form').reset();
  document.getElementById('selected-patient-id').value = '';
  document.getElementById('patient-search-results').innerHTML = '';
}

// í™˜ì ê²€ìƒ‰ ì´ˆê¸°í™”
function initializePatientSearch() {
  const searchInput = document.getElementById('patient-search');
  let debounceTimer;
  
  searchInput.addEventListener('input', function(e) {
    const query = e.target.value.trim();
    
    clearTimeout(debounceTimer);
    debounceTimer = setTimeout(() => {
      if (query.length >= 2) {
        searchPatients(query);
      } else {
        document.getElementById('patient-search-results').innerHTML = '';
      }
    }, 300);
  });
}

// í™˜ì ê²€ìƒ‰
async function searchPatients(query) {
  try {
    const response = await api.get(`/patients/search?q=${encodeURIComponent(query)}`);
    
    if (response.data.status === 'success') {
      displayPatientSearchResults(response.data.data.patients);
    }
  } catch (error) {
    console.error('í™˜ì ê²€ìƒ‰ ì˜¤ë¥˜:', error);
  }
}

// í™˜ì ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ
function displayPatientSearchResults(patients) {
  const container = document.getElementById('patient-search-results');
  
  if (!patients || patients.length === 0) {
    container.innerHTML = '<div class="p-2 text-sm text-gray-500">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
    return;
  }
  
  const html = patients.map(patient => `
    <div class="p-2 hover:bg-gray-100 cursor-pointer border-b" onclick="selectPatient(${patient.id}, '${patient.name}', '${patient.phone}')">
      <div class="text-sm font-medium text-gray-900">${patient.name}</div>
      <div class="text-sm text-gray-500">${patient.age}ì„¸ Â· ${patient.gender_text} Â· ğŸ“ ${patient.phone}</div>
    </div>
  `).join('');
  
  container.innerHTML = html;
}

// í™˜ì ì„ íƒ
function selectPatient(patientId, patientName, patientPhone) {
  document.getElementById('selected-patient-id').value = patientId;
  document.getElementById('patient-search').value = `${patientName} (${patientPhone})`;
  document.getElementById('patient-search-results').innerHTML = '';
}

// ì˜ì‚¬ ëª©ë¡ ë¡œë“œ
async function loadDoctorsList() {
  try {
    const response = await api.get('/employees?department=ì˜ë£Œì§„');
    
    if (response.data.status === 'success') {
      const select = document.getElementById('doctor-select');
      const doctors = response.data.data.employees;
      
      // ê¸°ì¡´ ì˜µì…˜ ì œê±° (ì²« ë²ˆì§¸ ì˜µì…˜ ì œì™¸)
      while (select.children.length > 1) {
        select.removeChild(select.lastChild);
      }
      
      // ì˜ì‚¬ ì˜µì…˜ ì¶”ê°€
      doctors.forEach(doctor => {
        const option = document.createElement('option');
        option.value = doctor.id;
        option.textContent = `${doctor.name} (${doctor.position})`;
        select.appendChild(option);
      });
    }
  } catch (error) {
    console.error('ì˜ì‚¬ ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
  }
}

// ìƒˆ ì˜ˆì•½ ë“±ë¡
document.getElementById('appointment-form').addEventListener('submit', async function(e) {
  e.preventDefault();
  
  const patientId = document.getElementById('selected-patient-id').value;
  if (!patientId) {
    toast.warning('í™˜ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
    return;
  }
  
  const formData = {
    patient_id: parseInt(patientId),
    employee_id: document.getElementById('doctor-select').value || null,
    appointment_date: `${document.getElementById('appointment-date').value}T${document.getElementById('appointment-time').value}:00`,
    appointment_type: document.getElementById('appointment-type').value,
    department: document.getElementById('appointment-department').value,
    chief_complaint: document.getElementById('chief-complaint').value
  };
  
  try {
    const response = await api.post('/appointments', { appointment: formData });
    
    if (response.data.status === 'success') {
      toast.success(response.data.message);
      closeAppointmentModal();
      await loadAppointmentDashboard();
      await loadAppointments();
    }
  } catch (error) {
    console.error('ì˜ˆì•½ ë“±ë¡ ì˜¤ë¥˜:', error);
    toast.error(error.response?.data?.message || 'ì˜ˆì•½ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
  }
});

// ì˜ˆì•½ í™•ì •
async function confirmAppointment(appointmentId) {
  const employeeId = prompt('ë‹´ë‹¹ì˜ IDë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­):');
  
  try {
    const data = {};
    if (employeeId && employeeId.trim()) {
      data.employee_id = parseInt(employeeId.trim());
    }
    
    const response = await api.patch(`/appointments/${appointmentId}/confirm`, data);
    
    if (response.data.status === 'success') {
      toast.success(response.data.message);
      await loadAppointmentDashboard();
      await loadAppointments();
    }
  } catch (error) {
    console.error('ì˜ˆì•½ í™•ì • ì˜¤ë¥˜:', error);
    toast.error(error.response?.data?.message || 'ì˜ˆì•½ í™•ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
  }
}

// ì˜ˆì•½ ì·¨ì†Œ
async function cancelAppointment(appointmentId) {
  const reason = prompt('ì·¨ì†Œ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
  if (!reason) return;
  
  try {
    const response = await api.patch(`/appointments/${appointmentId}/cancel`, {
      reason: reason
    });
    
    if (response.data.status === 'success') {
      toast.success(response.data.message);
      await loadAppointmentDashboard();
      await loadAppointments();
    }
  } catch (error) {
    console.error('ì˜ˆì•½ ì·¨ì†Œ ì˜¤ë¥˜:', error);
    toast.error(error.response?.data?.message || 'ì˜ˆì•½ ì·¨ì†Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
  }
}

// ë‚´ì› í™•ì¸
async function arriveAppointment(appointmentId) {
  try {
    const response = await api.patch(`/appointments/${appointmentId}/arrive`);
    
    if (response.data.status === 'success') {
      toast.success(response.data.message);
      await loadAppointmentDashboard();
      await loadAppointments();
    }
  } catch (error) {
    console.error('ë‚´ì› í™•ì¸ ì˜¤ë¥˜:', error);
    toast.error(error.response?.data?.message || 'ë‚´ì› í™•ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
  }
}

// ì˜ˆì•½ ìƒì„¸ ì •ë³´ ë³´ê¸°
async function viewAppointmentDetail(appointmentId) {
  try {
    // ì‹¤ì œ API í˜¸ì¶œ ëŒ€ì‹  ìƒ˜í”Œ ë°ì´í„° ì‚¬ìš©
    // const response = await api.get(`/appointments/${appointmentId}`);
    
    const appointment = getDetailedAppointmentData(appointmentId);
    
    if (appointment) {
      displayAppointmentDetail(appointment);
      document.getElementById('appointment-detail-modal').classList.remove('hidden');
    } else {
      toast.error('í•´ë‹¹ ì˜ˆì•½ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    }
  } catch (error) {
    console.error('ì˜ˆì•½ ìƒì„¸ ì •ë³´ ë¡œë“œ ì˜¤ë¥˜:', error);
    toast.error('ì˜ˆì•½ ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
  }
}

// ìƒì„¸ ì˜ˆì•½ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (ìƒ˜í”Œ)
function getDetailedAppointmentData(appointmentId) {
  const detailedData = {
    'list-1': {
      id: 'list-1',
      patient_info: {
        name: 'ê¹€í™˜ì',
        age: 45,
        gender_text: 'ë‚¨ì„±',
        phone: '010-1234-5678',
        email: 'kim@example.com',
        address: 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123-45',
        birth_date: '1979-03-15',
        patient_number: 'P2025001234',
        insurance_type_text: 'ê±´ê°•ë³´í—˜',
        emergency_contact: '010-9999-8888 (ë°°ìš°ì)',
        blood_type: 'Aí˜•',
        allergies: 'í˜ë‹ˆì‹¤ë¦° ì•Œë ˆë¥´ê¸°'
      },
      appointment_date: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString(),
      formatted_appointment_date: '2025ë…„ 01ì›” 13ì¼ 14:30',
      appointment_type_text: 'ê±´ê°•ê²€ì§„',
      department: 'ì˜ë£Œì§„',
      doctor_name: 'ì´ë‚´ê³¼',
      doctor_specialty: 'ë‚´ê³¼ ì „ë¬¸ì˜',
      chief_complaint: 'ì •ê¸° ê±´ê°•ê²€ì§„ì„ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤. ë‹¹ë‡¨ ê°€ì¡±ë ¥ì´ ìˆì–´ì„œ í˜ˆë‹¹ ê²€ì‚¬ í¬í•¨í•´ì„œ ì¢…í•©ì ìœ¼ë¡œ ê²€ì‚¬ ë°›ê³  ì‹¶ì–´ìš”.',
      status: 'confirmed',
      status_text: 'ì˜ˆì•½ í™•ì •',
      status_color: 'bg-blue-100 text-blue-800',
      created_by_patient: false,
      notes: 'ê°€ì¡±ë ¥ í™•ì¸ í•„ìš”. ë‹¹ë‡¨ ê²€ì‚¬ ìš°ì„ ì ìœ¼ë¡œ ì§„í–‰ ì˜ˆì •',
      medical_history: 'ê³ í˜ˆì•• (2020ë…„ ì§„ë‹¨), ë‹¹ë‡¨ ê°€ì¡±ë ¥ (ë¶€ëª¨)',
      current_medications: 'í˜ˆì••ì•½ (ì•”ë¡œë””í•€ 5mg), ì¢…í•©ë¹„íƒ€ë¯¼',
      previous_visits: [
        { date: '2024-07-15', type: 'ì •ê¸°ê²€ì§„', result: 'ì •ìƒ' },
        { date: '2024-01-20', type: 'í˜ˆì••ê²€ì‚¬', result: 'ê²½ë¯¸í•œ ê³ í˜ˆì••' }
      ],
      requested_tests: ['í˜ˆë‹¹ê²€ì‚¬', 'ì½œë ˆìŠ¤í…Œë¡¤ ê²€ì‚¬', 'ê°„ê¸°ëŠ¥ ê²€ì‚¬', 'ì‹ ì¥ê¸°ëŠ¥ ê²€ì‚¬'],
      estimated_duration: '2-3ì‹œê°„',
      preparation_notes: 'ê²€ì‚¬ 12ì‹œê°„ ì „ë¶€í„° ê¸ˆì‹í•´ì£¼ì„¸ìš”',
      can_confirm: false,
      can_cancel: true,
      can_arrive: false
    },
    'list-2': {
      id: 'list-2',
      patient_info: {
        name: 'ë°•í™˜ì',
        age: 32,
        gender_text: 'ì—¬ì„±',
        phone: '010-9876-5432',
        email: 'park@example.com',
        address: 'ì„œìš¸ì‹œ ì„œì´ˆêµ¬ ì„œì´ˆë™ 567-89',
        birth_date: '1992-11-22',
        patient_number: 'P2025001235',
        insurance_type_text: 'ì˜ë£Œê¸‰ì—¬ 1ì¢…',
        emergency_contact: '010-7777-6666 (ëª¨ì¹œ)',
        blood_type: 'Bí˜•',
        allergies: 'íŠ¹ì´ì‚¬í•­ ì—†ìŒ'
      },
      appointment_date: new Date(Date.now() + 1 * 24 * 60 * 60 * 1000).toISOString(),
      formatted_appointment_date: '2025ë…„ 01ì›” 12ì¼ 10:00',
      appointment_type_text: 'ì§„ë£Œ ìƒë‹´',
      department: 'ì˜ë£Œì§„',
      doctor_name: 'ê¹€ê°€ì •ì˜í•™',
      doctor_specialty: 'ê°€ì •ì˜í•™ê³¼ ì „ë¬¸ì˜',
      chief_complaint: 'ìµœê·¼ ë³µí†µì´ ì§€ì†ë˜ê³  ìˆìŠµë‹ˆë‹¤. ì†Œí™”ë¶ˆëŸ‰ì¸ ê²ƒ ê°™ì€ë° ì •í™•í•œ ì§„ë‹¨ì„ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤.',
      status: 'pending',
      status_text: 'ì˜ˆì•½ ëŒ€ê¸°',
      status_color: 'bg-yellow-100 text-yellow-800',
      created_by_patient: true,
      notes: 'ì˜¨ë¼ì¸ìœ¼ë¡œ ì‹ ì²­ëœ ì˜ˆì•½ì…ë‹ˆë‹¤. ë³µí†µ ì¦ìƒ ìì„¸í•œ ë¬¸ì§„ í•„ìš”',
      medical_history: 'ìœ„ì—¼ (2023ë…„ ì§„ë‹¨)',
      current_medications: 'ìœ„ì¥ì•½ (ì˜¤ë©”í”„ë¼ì¡¸ 20mg)',
      previous_visits: [
        { date: '2023-09-10', type: 'ìœ„ë‚´ì‹œê²½', result: 'ë§Œì„±ìœ„ì—¼' },
        { date: '2023-05-15', type: 'ë³µí†µ ìƒë‹´', result: 'ìœ„ì—¼ ì§„ë‹¨' }
      ],
      symptoms_duration: '2ì£¼ê°„ ì§€ì†',
      pain_scale: '5/10',
      related_symptoms: ['ì‹í›„ ë¶ˆí¸ê°', 'ì†ì“°ë¦¼', 'íŠ¸ë¦¼'],
      estimated_duration: '30-45ë¶„',
      preparation_notes: 'ì¦ìƒ ì¼ì§€ ì‘ì„±í•´ì„œ ê°€ì ¸ì™€ì£¼ì„¸ìš”',
      can_confirm: true,
      can_cancel: true,
      can_arrive: false
    },
    'list-3': {
      id: 'list-3',
      patient_info: {
        name: 'ìµœí™˜ì',
        age: 28,
        gender_text: 'ë‚¨ì„±',
        phone: '010-1111-2222',
        email: 'choi@example.com',
        address: 'ì„œìš¸ì‹œ ë§ˆí¬êµ¬ ìƒì•”ë™ 111-22',
        birth_date: '1996-05-08',
        patient_number: 'P2025001236',
        insurance_type_text: 'ê±´ê°•ë³´í—˜',
        emergency_contact: '010-5555-4444 (ë¶€ì¹œ)',
        blood_type: 'Oí˜•',
        allergies: 'íŠ¹ì´ì‚¬í•­ ì—†ìŒ'
      },
      appointment_date: new Date(Date.now() + 3 * 60 * 60 * 1000).toISOString(),
      formatted_appointment_date: '2025ë…„ 01ì›” 11ì¼ 16:30',
      appointment_type_text: 'ì‘ê¸‰ì§„ë£Œ',
      department: 'ì˜ë£Œì§„',
      doctor_name: 'ì‘ê¸‰ì˜ë£Œì§„',
      doctor_specialty: 'ì‘ê¸‰ì˜í•™ê³¼ ì „ë¬¸ì˜',
      chief_complaint: 'ê°‘ì‘ìŠ¤ëŸ° í‰í†µê³¼ í˜¸í¡ê³¤ë€ ì¦ìƒì´ ìˆìŠµë‹ˆë‹¤. ì‘ê¸‰ì§„ë£Œê°€ í•„ìš”í•©ë‹ˆë‹¤.',
      status: 'arrived',
      status_text: 'ë‚´ì› ì™„ë£Œ',
      status_color: 'bg-purple-100 text-purple-800',
      created_by_patient: false,
      notes: 'ì‘ê¸‰ì‹¤ ì§ì ‘ ë‚´ì›. Triage Level 3. í˜„ì¬ ê²€ì‚¬ ì§„í–‰ì¤‘',
      medical_history: 'íŠ¹ì´ì‚¬í•­ ì—†ìŒ',
      current_medications: 'ì—†ìŒ',
      vital_signs: {
        blood_pressure: '140/90 mmHg',
        heart_rate: '95 bpm',
        temperature: '37.2Â°C',
        oxygen_saturation: '98%'
      },
      triage_level: 'Level 3 (ì‘ê¸‰)',
      arrival_method: 'ë„ë³´',
      symptoms_onset: '1ì‹œê°„ ì „',
      estimated_duration: '2-4ì‹œê°„',
      current_status: 'ì‹¬ì „ë„ ë° í‰ë¶€ X-ray ì´¬ì˜ì¤‘',
      can_confirm: false,
      can_cancel: false,
      can_arrive: false
    }
  };
  
  return detailedData[appointmentId] || null;
}

// ì˜ˆì•½ ìƒì„¸ ì •ë³´ í‘œì‹œ
function displayAppointmentDetail(appointment) {
  const html = `
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- í™˜ì ê¸°ë³¸ ì •ë³´ -->
      <div class="space-y-4">
        <h4 class="text-md font-semibold text-gray-900 flex items-center">
          <span class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-2">
            <span class="text-sm font-bold text-blue-600">${appointment.patient_info.name.charAt(0)}</span>
          </span>
          í™˜ì ì •ë³´
        </h4>
        <div class="bg-gray-50 p-4 rounded-lg space-y-3">
          <div><span class="font-medium text-gray-700">ì´ë¦„:</span> <span class="text-gray-900">${appointment.patient_info.name}</span></div>
          <div><span class="font-medium text-gray-700">ë‚˜ì´/ì„±ë³„:</span> <span class="text-gray-900">${appointment.patient_info.age}ì„¸ Â· ${appointment.patient_info.gender_text}</span></div>
          <div><span class="font-medium text-gray-700">ìƒë…„ì›”ì¼:</span> <span class="text-gray-900">${appointment.patient_info.birth_date || '-'}</span></div>
          <div><span class="font-medium text-gray-700">í™˜ìë²ˆí˜¸:</span> <span class="text-gray-900 font-mono text-sm">${appointment.patient_info.patient_number || '-'}</span></div>
          <div><span class="font-medium text-gray-700">ì—°ë½ì²˜:</span> <span class="text-gray-900">${appointment.patient_info.phone}</span></div>
          <div><span class="font-medium text-gray-700">ì´ë©”ì¼:</span> <span class="text-gray-900">${appointment.patient_info.email || '-'}</span></div>
          ${appointment.patient_info.address ? `<div><span class="font-medium text-gray-700">ì£¼ì†Œ:</span> <span class="text-gray-900 text-sm">${appointment.patient_info.address}</span></div>` : ''}
          <div><span class="font-medium text-gray-700">ë³´í—˜:</span> <span class="text-gray-900">${appointment.patient_info.insurance_type_text}</span></div>
          ${appointment.patient_info.emergency_contact ? `<div><span class="font-medium text-gray-700">ë¹„ìƒì—°ë½ì²˜:</span> <span class="text-gray-900 text-sm">${appointment.patient_info.emergency_contact}</span></div>` : ''}
        </div>
      </div>
      
      <!-- ì˜ˆì•½ ì •ë³´ -->
      <div class="space-y-4">
        <h4 class="text-md font-semibold text-gray-900 flex items-center">
          <span class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-2">
            <span class="text-sm">ğŸ“…</span>
          </span>
          ì˜ˆì•½ ì •ë³´
        </h4>
        <div class="bg-gray-50 p-4 rounded-lg space-y-3">
          <div><span class="font-medium text-gray-700">ì˜ˆì•½ì¼ì‹œ:</span> <span class="text-gray-900 font-medium">${appointment.formatted_appointment_date}</span></div>
          <div><span class="font-medium text-gray-700">ì˜ˆì•½ìœ í˜•:</span> <span class="text-gray-900">${appointment.appointment_type_text}</span></div>
          <div><span class="font-medium text-gray-700">ì§„ë£Œê³¼:</span> <span class="text-gray-900">${appointment.department}</span></div>
          <div><span class="font-medium text-gray-700">ë‹´ë‹¹ì˜:</span> <span class="text-gray-900">${appointment.doctor_name || 'ë¯¸ë°°ì •'}</span>
            ${appointment.doctor_specialty ? `<div class="text-sm text-gray-500 ml-2">${appointment.doctor_specialty}</div>` : ''}
          </div>
          <div><span class="font-medium text-gray-700">ìƒíƒœ:</span> <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${appointment.status_color}">${appointment.status_text}</span></div>
          <div><span class="font-medium text-gray-700">ì‹ ì²­ë°©ì‹:</span> <span class="text-gray-900">${appointment.created_by_patient ? 'ì˜¨ë¼ì¸ ì‹ ì²­' : 'ì§ì ‘ ì ‘ìˆ˜'}</span></div>
          ${appointment.estimated_duration ? `<div><span class="font-medium text-gray-700">ì˜ˆìƒ ì†Œìš”ì‹œê°„:</span> <span class="text-gray-900">${appointment.estimated_duration}</span></div>` : ''}
        </div>
      </div>
      
      <!-- ì˜ë£Œ ì •ë³´ -->
      <div class="space-y-4">
        <h4 class="text-md font-semibold text-gray-900 flex items-center">
          <span class="w-8 h-8 bg-red-100 rounded-full flex items-center justify-center mr-2">
            <span class="text-sm">ğŸ©º</span>
          </span>
          ì˜ë£Œ ì •ë³´
        </h4>
        <div class="bg-gray-50 p-4 rounded-lg space-y-3">
          ${appointment.patient_info.blood_type ? `<div><span class="font-medium text-gray-700">í˜ˆì•¡í˜•:</span> <span class="text-gray-900">${appointment.patient_info.blood_type}</span></div>` : ''}
          ${appointment.patient_info.allergies ? `<div><span class="font-medium text-gray-700">ì•Œë ˆë¥´ê¸°:</span> <span class="text-gray-900">${appointment.patient_info.allergies}</span></div>` : ''}
          ${appointment.medical_history ? `<div><span class="font-medium text-gray-700">ê³¼ê±°ë ¥:</span> <span class="text-gray-900 text-sm">${appointment.medical_history}</span></div>` : ''}
          ${appointment.current_medications ? `<div><span class="font-medium text-gray-700">ë³µìš©ì•½ë¬¼:</span> <span class="text-gray-900 text-sm">${appointment.current_medications}</span></div>` : ''}
          
          ${appointment.vital_signs ? `
          <div class="pt-2 border-t border-gray-200">
            <div class="font-medium text-gray-700 mb-2">ìƒì²´ì§•í›„:</div>
            <div class="grid grid-cols-2 gap-2 text-sm">
              <div>í˜ˆì••: ${appointment.vital_signs.blood_pressure}</div>
              <div>ë§¥ë°•: ${appointment.vital_signs.heart_rate}</div>
              <div>ì²´ì˜¨: ${appointment.vital_signs.temperature}</div>
              <div>ì‚°ì†Œí¬í™”ë„: ${appointment.vital_signs.oxygen_saturation}</div>
            </div>
          </div>
          ` : ''}
          
          ${appointment.triage_level ? `<div><span class="font-medium text-gray-700">ì‘ê¸‰ë„:</span> <span class="text-red-600 font-medium">${appointment.triage_level}</span></div>` : ''}
        </div>
      </div>
    </div>
    
    <!-- ì£¼ì¦ìƒ ë° ìƒì„¸ ë‚´ìš© -->
    <div class="mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div>
        <h4 class="text-md font-semibold text-gray-900 mb-3">ì£¼ì¦ìƒ ë° ë‚´ì›ì‚¬ìœ </h4>
        <div class="bg-blue-50 p-4 rounded-lg">
          <p class="text-sm text-gray-800 leading-relaxed">${appointment.chief_complaint}</p>
          ${appointment.symptoms_duration ? `<div class="mt-2 text-xs text-blue-600">ì§€ì†ê¸°ê°„: ${appointment.symptoms_duration}</div>` : ''}
          ${appointment.pain_scale ? `<div class="mt-1 text-xs text-blue-600">í†µì¦ê°•ë„: ${appointment.pain_scale}</div>` : ''}
          ${appointment.related_symptoms ? `<div class="mt-2"><span class="text-xs text-blue-600 font-medium">ê´€ë ¨ì¦ìƒ:</span> <span class="text-xs text-gray-600">${appointment.related_symptoms.join(', ')}</span></div>` : ''}
        </div>
      </div>
      
      <div>
        <h4 class="text-md font-semibold text-gray-900 mb-3">ì§„ë£Œ ì •ë³´</h4>
        <div class="space-y-3">
          ${appointment.notes ? `
          <div class="bg-yellow-50 p-4 rounded-lg">
            <div class="font-medium text-sm text-gray-700 mb-1">ì§„ë£Œ ë©”ëª¨:</div>
            <p class="text-sm text-gray-800">${appointment.notes}</p>
          </div>
          ` : ''}
          
          ${appointment.preparation_notes ? `
          <div class="bg-green-50 p-4 rounded-lg">
            <div class="font-medium text-sm text-gray-700 mb-1">ì¤€ë¹„ì‚¬í•­:</div>
            <p class="text-sm text-gray-800">${appointment.preparation_notes}</p>
          </div>
          ` : ''}
          
          ${appointment.requested_tests ? `
          <div class="bg-purple-50 p-4 rounded-lg">
            <div class="font-medium text-sm text-gray-700 mb-2">ìš”ì²­ ê²€ì‚¬:</div>
            <div class="flex flex-wrap gap-1">
              ${appointment.requested_tests.map(test => `<span class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-800">${test}</span>`).join('')}
            </div>
          </div>
          ` : ''}
          
          ${appointment.current_status ? `
          <div class="bg-indigo-50 p-4 rounded-lg">
            <div class="font-medium text-sm text-gray-700 mb-1">í˜„ì¬ ìƒíƒœ:</div>
            <p class="text-sm text-gray-800">${appointment.current_status}</p>
          </div>
          ` : ''}
        </div>
      </div>
    </div>
    
    <!-- ì´ì „ ë°©ë¬¸ ê¸°ë¡ -->
    ${appointment.previous_visits && appointment.previous_visits.length > 0 ? `
    <div class="mt-6">
      <h4 class="text-md font-semibold text-gray-900 mb-3">ì´ì „ ë°©ë¬¸ ê¸°ë¡</h4>
      <div class="bg-gray-50 rounded-lg overflow-hidden">
        <div class="divide-y divide-gray-200">
          ${appointment.previous_visits.map(visit => `
          <div class="p-4 hover:bg-gray-100">
            <div class="flex items-center justify-between">
              <div>
                <div class="text-sm font-medium text-gray-900">${visit.date} - ${visit.type}</div>
                <div class="text-sm text-gray-600">${visit.result}</div>
              </div>
              <span class="text-xs text-gray-400">ì™„ë£Œ</span>
            </div>
          </div>
          `).join('')}
        </div>
      </div>
    </div>
    ` : ''}
    
    <!-- ì•¡ì…˜ ë²„íŠ¼ -->
    <div class="mt-8 flex justify-end space-x-3 pt-6 border-t border-gray-200">
      ${appointment.can_confirm ? `<button onclick="confirmAppointment('${appointment.id}'); closeAppointmentDetailModal();" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">ì˜ˆì•½ í™•ì •</button>` : ''}
      ${appointment.can_cancel ? `<button onclick="cancelAppointment('${appointment.id}'); closeAppointmentDetailModal();" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors">ì˜ˆì•½ ì·¨ì†Œ</button>` : ''}
      ${appointment.can_arrive ? `<button onclick="arriveAppointment('${appointment.id}'); closeAppointmentDetailModal();" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">ë‚´ì› í™•ì¸</button>` : ''}
      <button onclick="printAppointmentDetail('${appointment.id}')" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors">ì¸ì‡„</button>
      <button onclick="closeAppointmentDetailModal()" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors">ë‹«ê¸°</button>
    </div>
  `;
  
  document.getElementById('appointment-detail-content').innerHTML = html;
}

// ì˜ˆì•½ ìƒì„¸ ì •ë³´ ì¸ì‡„
function printAppointmentDetail(appointmentId) {
  const appointment = getDetailedAppointmentData(appointmentId);
  if (!appointment) {
    toast.error('ì¸ì‡„í•  ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }
  
  const printWindow = window.open('', '_blank');
  const printContent = `
    <html>
      <head>
        <title>ì˜ˆì•½ ìƒì„¸ ì •ë³´ - ${appointment.patient_info.name}</title>
        <style>
          body { font-family: 'Malgun Gothic', sans-serif; margin: 20px; line-height: 1.6; }
          .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
          .section { margin-bottom: 20px; }
          .section h3 { background-color: #f5f5f5; padding: 8px; margin: 0 0 10px 0; border-left: 4px solid #333; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
          .info-item { margin-bottom: 8px; }
          .label { font-weight: bold; display: inline-block; width: 120px; }
          .value { color: #333; }
          .complaint { background-color: #f9f9f9; padding: 15px; border-radius: 5px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>ğŸ¥ ë³‘ì› ì˜ˆì•½ ìƒì„¸ ì •ë³´</h1>
          <p>ì¶œë ¥ì¼ì‹œ: ${new Date().toLocaleDateString('ko-KR')} ${new Date().toLocaleTimeString('ko-KR')}</p>
        </div>
        
        <div class="info-grid">
          <div class="section">
            <h3>í™˜ì ì •ë³´</h3>
            <div class="info-item"><span class="label">í™˜ìëª…:</span> <span class="value">${appointment.patient_info.name}</span></div>
            <div class="info-item"><span class="label">í™˜ìë²ˆí˜¸:</span> <span class="value">${appointment.patient_info.patient_number || '-'}</span></div>
            <div class="info-item"><span class="label">ë‚˜ì´/ì„±ë³„:</span> <span class="value">${appointment.patient_info.age}ì„¸ / ${appointment.patient_info.gender_text}</span></div>
            <div class="info-item"><span class="label">ì—°ë½ì²˜:</span> <span class="value">${appointment.patient_info.phone}</span></div>
            <div class="info-item"><span class="label">ë³´í—˜ìœ í˜•:</span> <span class="value">${appointment.patient_info.insurance_type_text}</span></div>
          </div>
          
          <div class="section">
            <h3>ì˜ˆì•½ ì •ë³´</h3>
            <div class="info-item"><span class="label">ì˜ˆì•½ì¼ì‹œ:</span> <span class="value">${appointment.formatted_appointment_date}</span></div>
            <div class="info-item"><span class="label">ì˜ˆì•½ìœ í˜•:</span> <span class="value">${appointment.appointment_type_text}</span></div>
            <div class="info-item"><span class="label">ì§„ë£Œê³¼:</span> <span class="value">${appointment.department}</span></div>
            <div class="info-item"><span class="label">ë‹´ë‹¹ì˜:</span> <span class="value">${appointment.doctor_name || 'ë¯¸ë°°ì •'}</span></div>
            <div class="info-item"><span class="label">í˜„ì¬ìƒíƒœ:</span> <span class="value">${appointment.status_text}</span></div>
          </div>
        </div>
        
        <div class="section">
          <h3>ì£¼ì¦ìƒ ë° ë‚´ì›ì‚¬ìœ </h3>
          <div class="complaint">${appointment.chief_complaint}</div>
        </div>
        
        ${appointment.medical_history ? `
        <div class="section">
          <h3>ê³¼ê±°ë ¥ ë° ë³µìš©ì•½ë¬¼</h3>
          <div class="info-item"><span class="label">ê³¼ê±°ë ¥:</span> <span class="value">${appointment.medical_history}</span></div>
          ${appointment.current_medications ? `<div class="info-item"><span class="label">ë³µìš©ì•½ë¬¼:</span> <span class="value">${appointment.current_medications}</span></div>` : ''}
        </div>
        ` : ''}
        
        ${appointment.notes ? `
        <div class="section">
          <h3>ì§„ë£Œ ë©”ëª¨</h3>
          <div class="complaint">${appointment.notes}</div>
        </div>
        ` : ''}
      </body>
    </html>
  `;
  
  printWindow.document.write(printContent);
  printWindow.document.close();
  printWindow.print();
}

// ì˜ˆì•½ ìƒì„¸ ëª¨ë‹¬ ë‹«ê¸°
function closeAppointmentDetailModal() {
  document.getElementById('appointment-detail-modal').classList.add('hidden');
}

// ==================== ìº˜ë¦°ë” ê´€ë ¨ í•¨ìˆ˜ë“¤ ====================

// ë·° ì „í™˜ ì„¤ì •
function setupViewSwitching() {
  // ëª¨ë°”ì¼ ì…€ë ‰íŠ¸ ë°•ìŠ¤
  const selectElement = document.getElementById('view-tab-select');
  if (selectElement) {
    selectElement.addEventListener('change', (e) => {
      switchView(e.target.value);
    });
  }
}

// ë·° ì „í™˜ í•¨ìˆ˜
function switchView(view) {
  const listView = document.getElementById('list-view');
  const calendarView = document.getElementById('calendar-view');
  const listTab = document.getElementById('list-view-tab');
  const calendarTab = document.getElementById('calendar-view-tab');
  
  if (view === 'calendar') {
    listView.classList.add('hidden');
    calendarView.classList.remove('hidden');
    
    if (listTab && calendarTab) {
      listTab.classList.remove('view-tab-active');
      listTab.classList.add('view-tab-inactive');
      calendarTab.classList.remove('view-tab-inactive');
      calendarTab.classList.add('view-tab-active');
    }
    
    loadCalendarAppointments();
  } else {
    listView.classList.remove('hidden');
    calendarView.classList.add('hidden');
    
    if (listTab && calendarTab) {
      listTab.classList.remove('view-tab-inactive');
      listTab.classList.add('view-tab-active');
      calendarTab.classList.remove('view-tab-active');
      calendarTab.classList.add('view-tab-inactive');
    }
  }
}

// ìº˜ë¦°ë” ì´ˆê¸°í™”
function initializeCalendar() {
  currentCalendarDate = new Date();
  renderCalendar();
}

// ìº˜ë¦°ë” ë Œë”ë§
function renderCalendar() {
  const monthYear = document.getElementById('calendar-month-year');
  const calendarGrid = document.getElementById('calendar-grid');
  
  if (!monthYear || !calendarGrid) return;
  
  // ì›”/ë…„ í‘œì‹œ ì—…ë°ì´íŠ¸
  const year = currentCalendarDate.getFullYear();
  const month = currentCalendarDate.getMonth();
  const monthNames = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'];
  monthYear.textContent = `${year}ë…„ ${monthNames[month]}`;
  
  // ë‹¬ë ¥ ê·¸ë¦¬ë“œ ìƒì„±
  const firstDay = new Date(year, month, 1);
  const lastDay = new Date(year, month + 1, 0);
  const firstDayOfWeek = firstDay.getDay();
  const daysInMonth = lastDay.getDate();
  
  // ì´ì „ ë‹¬ì˜ ë§ˆì§€ë§‰ ë‚ ë“¤
  const prevMonthLastDay = new Date(year, month, 0).getDate();
  
  // ìº˜ë¦°ë” ì…€ ìƒì„±
  let html = '';
  let dayCount = 1;
  let nextMonthDay = 1;
  
  for (let week = 0; week < 6; week++) {
    for (let day = 0; day < 7; day++) {
      const cellIndex = week * 7 + day;
      let cellDate, cellDay, isCurrentMonth = true, isToday = false;
      
      if (cellIndex < firstDayOfWeek) {
        // ì´ì „ ë‹¬
        cellDay = prevMonthLastDay - firstDayOfWeek + cellIndex + 1;
        cellDate = new Date(year, month - 1, cellDay);
        isCurrentMonth = false;
      } else if (dayCount <= daysInMonth) {
        // í˜„ì¬ ë‹¬
        cellDay = dayCount;
        cellDate = new Date(year, month, cellDay);
        dayCount++;
        
        // ì˜¤ëŠ˜ ë‚ ì§œì¸ì§€ í™•ì¸
        const today = new Date();
        isToday = cellDate.toDateString() === today.toDateString();
      } else {
        // ë‹¤ìŒ ë‹¬
        cellDay = nextMonthDay;
        cellDate = new Date(year, month + 1, cellDay);
        nextMonthDay++;
        isCurrentMonth = false;
      }
      
      // í•´ë‹¹ ë‚ ì§œì˜ ì˜ˆì•½ ê°œìˆ˜ í™•ì¸
      const dayAppointments = getAppointmentsForDate(cellDate);
      const hasAppointments = dayAppointments.length > 0;
      
      // CSS í´ë˜ìŠ¤ ì„¤ì •
      let cellClasses = ['calendar-cell'];
      if (!isCurrentMonth) cellClasses.push('other-month');
      if (isToday) cellClasses.push('today');
      if (hasAppointments) cellClasses.push('has-appointments');
      if (selectedCalendarDate && cellDate.toDateString() === selectedCalendarDate.toDateString()) {
        cellClasses.push('selected');
      }
      
      // ì˜ˆì•½ ì´ë²¤íŠ¸ HTML ìƒì„±
      let eventsHtml = '';
      if (isCurrentMonth) {
        eventsHtml = dayAppointments.slice(0, 3).map(appointment => 
          `<div class="appointment-event ${appointment.status}" 
               onclick="viewAppointmentDetail(${appointment.id})" 
               title="${appointment.patient_name} - ${appointment.formatted_appointment_time}">
             ${appointment.formatted_appointment_time} ${appointment.patient_name}
           </div>`
        ).join('');
        
        if (dayAppointments.length > 3) {
          eventsHtml += `<div class="text-xs text-gray-500 mt-1">+${dayAppointments.length - 3}ê°œ ë”</div>`;
        }
      }
      
      html += `
        <div class="${cellClasses.join(' ')}" 
             data-date="${cellDate.toISOString().split('T')[0]}"
             onclick="selectCalendarDate('${cellDate.toISOString().split('T')[0]}')">
          <div class="font-medium text-sm mb-1">${cellDay}</div>
          ${eventsHtml}
        </div>
      `;
    }
    
    // ë§ˆì§€ë§‰ ì£¼ê°€ ëª¨ë‘ ë‹¤ìŒ ë‹¬ì´ë©´ ë” ì´ìƒ ì¶”ê°€í•˜ì§€ ì•ŠìŒ
    if (dayCount > daysInMonth && nextMonthDay > 7) break;
  }
  
  calendarGrid.innerHTML = html;
}

// íŠ¹ì • ë‚ ì§œì˜ ì˜ˆì•½ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
function getAppointmentsForDate(date) {
  const dateStr = date.toISOString().split('T')[0];
  return calendarAppointments.filter(appointment => {
    const appointmentDate = new Date(appointment.appointment_date).toISOString().split('T')[0];
    return appointmentDate === dateStr;
  });
}

// ìº˜ë¦°ë”ìš© ì˜ˆì•½ ë°ì´í„° ë¡œë“œ
async function loadCalendarAppointments() {
  try {
    const year = currentCalendarDate.getFullYear();
    const month = currentCalendarDate.getMonth();
    const startDate = new Date(year, month, 1).toISOString().split('T')[0];
    const endDate = new Date(year, month + 1, 0).toISOString().split('T')[0];
    
    const params = new URLSearchParams({
      start_date: startDate,
      end_date: endDate
    });
    
    // ë¶€ì„œ í•„í„° ì ìš©
    const departmentFilter = document.getElementById('calendar-department-filter');
    if (departmentFilter && departmentFilter.value) {
      params.append('department', departmentFilter.value);
    }
    
    // API í˜¸ì¶œ ëŒ€ì‹  ìƒ˜í”Œ ë°ì´í„° ì‚¬ìš© (ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ì£¼ì„ í•´ì œ)
    // const response = await api.get(`/appointments?${params.toString()}`);
    
    // ìƒ˜í”Œ ë°ì´í„° ìƒì„± (ì›”ë³„ë¡œ ë‹¤ë¥¸ ë°ì´í„°)
    calendarAppointments = generateSampleAppointments(year, month);
    
    // ìº˜ë¦°ë” ë Œë”ë§
    renderCalendar();
    
    /*
    // ì‹¤ì œ API ì‚¬ìš© ì‹œ
    if (response.data.status === 'success') {
      calendarAppointments = response.data.data.appointments;
      renderCalendar();
    }
    */
  } catch (error) {
    console.error('ìº˜ë¦°ë” ì˜ˆì•½ ë¡œë“œ ì˜¤ë¥˜:', error);
    toast.error('ìº˜ë¦°ë” ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
  }
}

// ìƒ˜í”Œ ì˜ˆì•½ ë°ì´í„° ìƒì„± (ì›”ë³„ë¡œ ë‹¤ë¥¸ ë°ì´í„°)
function generateSampleAppointments(year, month) {
  const appointments = [];
  const daysInMonth = new Date(year, month + 1, 0).getDate();
  
  // ì›”ë³„ë¡œ ë‹¤ë¥¸ ì‹œë“œ ê°’ì„ ì‚¬ìš©í•´ì„œ ë‹¤ë¥¸ ë°ì´í„° ìƒì„±
  const monthSeed = year * 12 + month;
  
  for (let day = 1; day <= daysInMonth; day++) {
    // ê° ë‚ ì§œë§ˆë‹¤ 0-4ê°œì˜ ì˜ˆì•½ ìƒì„±
    const appointmentCount = Math.floor(Math.random() * 5);
    
    for (let i = 0; i < appointmentCount; i++) {
      const hour = 9 + Math.floor(Math.random() * 8); // 9-16ì‹œ
      const minute = Math.floor(Math.random() * 4) * 15; // 0, 15, 30, 45ë¶„
      
      const appointmentDate = new Date(year, month, day, hour, minute);
      const patientNames = ['ê¹€í™˜ì', 'ì´í™˜ì', 'ë°•í™˜ì', 'ìµœí™˜ì', 'ì •í™˜ì', 'ê°•í™˜ì', 'ì¡°í™˜ì', 'ìœ¤í™˜ì'];
      const appointmentTypes = ['ê±´ê°•ê²€ì§„', 'ì§„ë£Œ ìƒë‹´', 'ì¹˜ë£Œ', 'ì¬ì§„', 'ì˜ˆë°©ì ‘ì¢…'];
      const statuses = ['pending', 'confirmed', 'arrived', 'completed'];
      
      // ì›” ì‹œë“œë¥¼ ì‚¬ìš©í•´ì„œ ì¼ê´€ëœ ëœë¤ ë°ì´í„° ìƒì„±
      const patientIndex = (monthSeed + day + i) % patientNames.length;
      const typeIndex = (monthSeed + day + i * 2) % appointmentTypes.length;
      const statusIndex = (monthSeed + day + i * 3) % statuses.length;
      
      appointments.push({
        id: `${monthSeed}-${day}-${i}`,
        patient_name: patientNames[patientIndex],
        patient_age: 25 + ((monthSeed + day + i) % 50),
        appointment_date: appointmentDate.toISOString(),
        formatted_appointment_time: `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`,
        formatted_appointment_date: appointmentDate.toLocaleDateString('ko-KR') + ' ' + `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`,
        appointment_type_text: appointmentTypes[typeIndex],
        department: 'ì˜ë£Œì§„',
        status: statuses[statusIndex],
        status_text: getStatusText(statuses[statusIndex]),
        status_color: getStatusColor(statuses[statusIndex]),
        doctor_name: 'ê¹€ì˜ì‚¬',
        can_confirm: statuses[statusIndex] === 'pending',
        can_cancel: ['pending', 'confirmed'].includes(statuses[statusIndex]),
        can_arrive: statuses[statusIndex] === 'confirmed'
      });
    }
  }
  
  return appointments.sort((a, b) => new Date(a.appointment_date) - new Date(b.appointment_date));
}

// ìƒíƒœ í…ìŠ¤íŠ¸ ë°˜í™˜
function getStatusText(status) {
  const statusTexts = {
    pending: 'ì˜ˆì•½ ëŒ€ê¸°',
    confirmed: 'ì˜ˆì•½ í™•ì •', 
    arrived: 'ë‚´ì› ì™„ë£Œ',
    completed: 'ì§„ë£Œ ì™„ë£Œ'
  };
  return statusTexts[status] || status;
}

// ìƒíƒœ ìƒ‰ìƒ ë°˜í™˜  
function getStatusColor(status) {
  const statusColors = {
    pending: 'bg-yellow-100 text-yellow-800',
    confirmed: 'bg-blue-100 text-blue-800',
    arrived: 'bg-purple-100 text-purple-800', 
    completed: 'bg-green-100 text-green-800'
  };
  return statusColors[status] || 'bg-gray-100 text-gray-800';
}

// ìº˜ë¦°ë” ë„¤ë¹„ê²Œì´ì…˜
function navigateCalendar(direction) {
  if (direction === 'prev') {
    currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1);
  } else if (direction === 'next') {
    currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1);
  }
  
  // ì„ íƒëœ ë‚ ì§œ ì´ˆê¸°í™”
  selectedCalendarDate = null;
  document.getElementById('selected-date-appointments').classList.add('hidden');
  
  // ìº˜ë¦°ë” ë‹¤ì‹œ ê·¸ë¦¬ê¸° ë° ë°ì´í„° ë¡œë“œ
  renderCalendar();
  loadCalendarAppointments();
}

// ì˜¤ëŠ˜ë¡œ ì´ë™
function goToToday() {
  currentCalendarDate = new Date();
  
  // ì„ íƒëœ ë‚ ì§œ ì´ˆê¸°í™”
  selectedCalendarDate = null;
  document.getElementById('selected-date-appointments').classList.add('hidden');
  
  // ìº˜ë¦°ë” ë‹¤ì‹œ ê·¸ë¦¬ê¸° ë° ë°ì´í„° ë¡œë“œ
  renderCalendar();
  loadCalendarAppointments();
}

// ìº˜ë¦°ë” ë‚ ì§œ ì„ íƒ
function selectCalendarDate(dateString) {
  selectedCalendarDate = new Date(dateString);
  
  // ì„ íƒëœ ë‚ ì§œ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
  document.querySelectorAll('.calendar-cell').forEach(cell => {
    cell.classList.remove('selected');
  });
  
  document.querySelector(`[data-date="${dateString}"]`).classList.add('selected');
  
  // ì„ íƒëœ ë‚ ì§œì˜ ì˜ˆì•½ ëª©ë¡ í‘œì‹œ
  displaySelectedDateAppointments(dateString);
}

// ì„ íƒëœ ë‚ ì§œì˜ ì˜ˆì•½ ëª©ë¡ í‘œì‹œ
function displaySelectedDateAppointments(dateString) {
  const selectedDate = new Date(dateString);
  const appointments = getAppointmentsForDate(selectedDate);
  
  const selectedDateText = document.getElementById('selected-date-text');
  const selectedDateContainer = document.getElementById('selected-date-appointments');
  const appointmentsList = document.getElementById('selected-date-appointments-list');
  
  if (!selectedDateText || !selectedDateContainer || !appointmentsList) return;
  
  // ë‚ ì§œ í…ìŠ¤íŠ¸ ì„¤ì •
  const dateFormatted = selectedDate.toLocaleDateString('ko-KR', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
    weekday: 'long'
  });
  selectedDateText.textContent = dateFormatted;
  
  // ì˜ˆì•½ ëª©ë¡ í‘œì‹œ
  if (appointments.length === 0) {
    appointmentsList.innerHTML = '<div class="p-4 text-center text-gray-500">í•´ë‹¹ ë‚ ì§œì— ì˜ˆì•½ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
  } else {
    const html = appointments.map(appointment => `
      <div class="p-4 hover:bg-white cursor-pointer" onclick="viewAppointmentDetail(${appointment.id})">
        <div class="flex items-center justify-between">
          <div class="flex-1">
            <div class="flex items-center">
              <span class="text-sm font-medium text-gray-900">${appointment.formatted_appointment_time}</span>
              <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${appointment.status_color}">
                ${appointment.status_text}
              </span>
            </div>
            <div class="mt-1">
              <span class="text-sm font-medium text-gray-900">${appointment.patient_name}</span>
              <span class="text-sm text-gray-500">(${appointment.patient_age}ì„¸)</span>
            </div>
            <div class="mt-1 text-sm text-gray-600">
              ${appointment.appointment_type_text} Â· ${appointment.department}
            </div>
            <div class="mt-1 text-sm text-gray-500">
              ë‹´ë‹¹ì˜: ${appointment.doctor_name || 'ë¯¸ë°°ì •'}
            </div>
          </div>
          <div class="ml-4 flex space-x-2">
            ${appointment.can_confirm ? `<button onclick="event.stopPropagation(); confirmAppointment(${appointment.id})" class="px-2 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700">í™•ì •</button>` : ''}
            ${appointment.can_cancel ? `<button onclick="event.stopPropagation(); cancelAppointment(${appointment.id})" class="px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700">ì·¨ì†Œ</button>` : ''}
            ${appointment.can_arrive ? `<button onclick="event.stopPropagation(); arriveAppointment(${appointment.id})" class="px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700">ë‚´ì›</button>` : ''}
          </div>
        </div>
      </div>
    `).join('');
    
    appointmentsList.innerHTML = html;
  }
  
  // ì„ íƒëœ ë‚ ì§œ ì„¹ì…˜ í‘œì‹œ
  selectedDateContainer.classList.remove('hidden');
}

// ìº˜ë¦°ë” ë¶€ì„œ í•„í„° ë³€ê²½ ì‹œ
document.getElementById('calendar-department-filter').addEventListener('change', () => {
  if (document.getElementById('calendar-view').classList.contains('hidden')) return;
  loadCalendarAppointments();
});

// ==================== ì˜¨ë¼ì¸ ì˜ˆì•½ ê´€ë ¨ í•¨ìˆ˜ë“¤ ====================

// ì˜¨ë¼ì¸ ì˜ˆì•½ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
function refreshOnlineAppointments() {
  loadAppointmentDashboard();
  toast.info('ì˜¨ë¼ì¸ ì˜ˆì•½ ëª©ë¡ì´ ìƒˆë¡œê³ ì¹¨ë˜ì—ˆìŠµë‹ˆë‹¤.');
}

// ì˜¨ë¼ì¸ ì˜ˆì•½ ìŠ¹ì¸ ì•¡ì…˜ í‘œì‹œ
function showOnlineAppointmentActions(appointmentId) {
  // ìƒ˜í”Œ ë°ì´í„° (ì‹¤ì œë¡œëŠ” APIì—ì„œ ê°€ì ¸ì™€ì•¼ í•¨)
  const sampleData = {
    1: {
      patient: { name: 'ê¹€í™˜ì', age: 45, phone: '010-1234-5678', gender: 'ë‚¨ì„±' },
      appointment: { date: '2025ë…„ 01ì›” 15ì¼ 14:30', type: 'ê±´ê°•ê²€ì§„', department: 'ì˜ë£Œì§„', complaint: 'ì •ê¸° ê±´ê°•ê²€ì§„ì„ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤. ë‹¹ë‡¨ ê°€ì¡±ë ¥ì´ ìˆì–´ì„œ í˜ˆë‹¹ ê²€ì‚¬ í¬í•¨í•´ì„œ ì¢…í•©ì ìœ¼ë¡œ ê²€ì‚¬ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤.' }
    },
    2: {
      patient: { name: 'ì´í™˜ì', age: 32, phone: '010-9876-5432', gender: 'ì—¬ì„±' },
      appointment: { date: '2025ë…„ 01ì›” 16ì¼ 10:00', type: 'ì§„ë£Œ ìƒë‹´', department: 'ì˜ë£Œì§„', complaint: 'ìµœê·¼ ë³µí†µì´ ì§€ì†ë˜ê³  ìˆìŠµë‹ˆë‹¤. ì†Œí™”ë¶ˆëŸ‰ì¸ ê²ƒ ê°™ì€ë° ì •í™•í•œ ì§„ë‹¨ì„ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤.' }
    },
    3: {
      patient: { name: 'ë°•í™˜ì', age: 28, phone: '010-1111-2222', gender: 'ë‚¨ì„±' },
      appointment: { date: '2025ë…„ 01ì›” 17ì¼ 16:00', type: 'ì˜ˆë°©ì ‘ì¢…', department: 'ê°„í˜¸ë¶€', complaint: 'í•´ì™¸ì—¬í–‰ ì˜ˆì •ì´ë¼ Aí˜• ê°„ì—¼ ì˜ˆë°©ì ‘ì¢…ì„ ë°›ê³  ì‹¶ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ í•„ìˆ˜ ì˜ˆë°©ì ‘ì¢…ë„ í•¨ê»˜ ìƒë‹´ ë°›ì„ ìˆ˜ ìˆë‚˜ìš”?' }
    }
  };
  
  const data = sampleData[appointmentId];
  if (!data) return;
  
  // í™˜ì ì •ë³´ í‘œì‹œ
  document.getElementById('online-patient-info').innerHTML = `
    <div class="space-y-1">
      <div><span class="font-medium">ì´ë¦„:</span> ${data.patient.name}</div>
      <div><span class="font-medium">ë‚˜ì´:</span> ${data.patient.age}ì„¸</div>
      <div><span class="font-medium">ì„±ë³„:</span> ${data.patient.gender}</div>
      <div><span class="font-medium">ì—°ë½ì²˜:</span> ${data.patient.phone}</div>
    </div>
  `;
  
  // ì˜ˆì•½ ì •ë³´ í‘œì‹œ
  document.getElementById('online-appointment-info').innerHTML = `
    <div class="space-y-2">
      <div><span class="font-medium">í¬ë§ ì¼ì‹œ:</span> ${data.appointment.date}</div>
      <div><span class="font-medium">ì˜ˆì•½ ìœ í˜•:</span> ${data.appointment.type}</div>
      <div><span class="font-medium">í¬ë§ ë¶€ì„œ:</span> ${data.appointment.department}</div>
      <div class="pt-2">
        <span class="font-medium">ì£¼ì¦ìƒ:</span>
        <p class="mt-1 text-gray-700">${data.appointment.complaint}</p>
      </div>
    </div>
  `;
  
  // ìŠ¹ì¸ ëª¨ë‹¬ ì—´ê¸°
  document.getElementById('online-appointment-approval-modal').classList.remove('hidden');
  
  // í˜„ì¬ ì²˜ë¦¬ì¤‘ì¸ ì˜ˆì•½ ID ì €ì¥
  window.currentOnlineAppointmentId = appointmentId;
}

// ì˜¨ë¼ì¸ ì˜ˆì•½ ìƒì„¸ ë³´ê¸°
function viewOnlineAppointmentDetail(appointmentId) {
  // ê¸°ì¡´ì˜ viewAppointmentDetail í•¨ìˆ˜ í™œìš©
  // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ì˜¨ë¼ì¸ ì˜ˆì•½ ì „ìš© ìƒì„¸ ëª¨ë‹¬ì„ ë§Œë“¤ ìˆ˜ ìˆìŒ
  toast.info(`ì˜¨ë¼ì¸ ì˜ˆì•½ ID ${appointmentId} ìƒì„¸ ì •ë³´`);
}

// ì˜¨ë¼ì¸ ì˜ˆì•½ ê±°ë¶€
function rejectOnlineAppointment(appointmentId) {
  // ìƒ˜í”Œ ë°ì´í„°
  const sampleData = {
    1: { patient: 'ê¹€í™˜ì (45ì„¸)', date: '2025ë…„ 01ì›” 15ì¼ 14:30', type: 'ê±´ê°•ê²€ì§„' },
    2: { patient: 'ì´í™˜ì (32ì„¸)', date: '2025ë…„ 01ì›” 16ì¼ 10:00', type: 'ì§„ë£Œ ìƒë‹´' },
    3: { patient: 'ë°•í™˜ì (28ì„¸)', date: '2025ë…„ 01ì›” 17ì¼ 16:00', type: 'ì˜ˆë°©ì ‘ì¢…' }
  };
  
  const data = sampleData[appointmentId];
  if (!data) return;
  
  // ê±°ë¶€ ëª¨ë‹¬ ì •ë³´ í‘œì‹œ
  document.getElementById('rejection-appointment-info').innerHTML = `
    <div class="space-y-1">
      <div><span class="font-medium">í™˜ì:</span> ${data.patient}</div>
      <div><span class="font-medium">í¬ë§ ì¼ì‹œ:</span> ${data.date}</div>
      <div><span class="font-medium">ì˜ˆì•½ ìœ í˜•:</span> ${data.type}</div>
    </div>
  `;
  
  // ê±°ë¶€ ëª¨ë‹¬ ì—´ê¸°
  document.getElementById('online-appointment-rejection-modal').classList.remove('hidden');
  
  // í˜„ì¬ ì²˜ë¦¬ì¤‘ì¸ ì˜ˆì•½ ID ì €ì¥
  window.currentRejectingAppointmentId = appointmentId;
}

// ì˜¨ë¼ì¸ ì˜ˆì•½ ìŠ¹ì¸ ëª¨ë‹¬ ë‹«ê¸°
function closeOnlineApprovalModal() {
  document.getElementById('online-appointment-approval-modal').classList.add('hidden');
  document.getElementById('online-approval-form').reset();
  window.currentOnlineAppointmentId = null;
}

// ì˜¨ë¼ì¸ ì˜ˆì•½ ê±°ë¶€ ëª¨ë‹¬ ë‹«ê¸°
function closeOnlineRejectionModal() {
  document.getElementById('online-appointment-rejection-modal').classList.add('hidden');
  document.getElementById('online-rejection-form').reset();
  window.currentRejectingAppointmentId = null;
}

// ì˜¨ë¼ì¸ ì˜ˆì•½ ìŠ¹ì¸ ì²˜ë¦¬
document.getElementById('online-approval-form').addEventListener('submit', async function(e) {
  e.preventDefault();
  
  const appointmentId = window.currentOnlineAppointmentId;
  const doctorId = document.getElementById('assigned-doctor').value;
  const notes = document.getElementById('appointment-notes').value;
  
  try {
    // ì‹¤ì œ API í˜¸ì¶œ (í˜„ì¬ëŠ” ì‹œë®¬ë ˆì´ì…˜)
    await new Promise(resolve => setTimeout(resolve, 1000)); // API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜
    
    toast.success(`ì˜¨ë¼ì¸ ì˜ˆì•½ ID ${appointmentId}ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.`);
    closeOnlineApprovalModal();
    
    // UIì—ì„œ í•´ë‹¹ í•­ëª© ì œê±° ë˜ëŠ” ìƒíƒœ ì—…ë°ì´íŠ¸
    const listItem = document.querySelector(`button[onclick*="${appointmentId}"]`)?.closest('li');
    if (listItem) {
      listItem.style.opacity = '0.5';
      listItem.querySelector('.bg-yellow-100').className = 'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800';
      listItem.querySelector('.bg-yellow-100').textContent = 'ìŠ¹ì¸ ì™„ë£Œ';
      
      // ë²„íŠ¼ë“¤ ë¹„í™œì„±í™”
      const buttons = listItem.querySelectorAll('button');
      buttons.forEach(btn => {
        btn.disabled = true;
        btn.classList.add('opacity-50', 'cursor-not-allowed');
      });
    }
    
    // í†µê³„ ì—…ë°ì´íŠ¸
    loadAppointmentDashboard();
    
  } catch (error) {
    console.error('ì˜¨ë¼ì¸ ì˜ˆì•½ ìŠ¹ì¸ ì˜¤ë¥˜:', error);
    toast.error('ì˜¨ë¼ì¸ ì˜ˆì•½ ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
  }
});

// ì˜¨ë¼ì¸ ì˜ˆì•½ ê±°ë¶€ ì²˜ë¦¬
document.getElementById('online-rejection-form').addEventListener('submit', async function(e) {
  e.preventDefault();
  
  const appointmentId = window.currentRejectingAppointmentId;
  const reason = document.getElementById('rejection-reason').value;
  const message = document.getElementById('rejection-message').value;
  
  if (!reason) {
    toast.warning('ê±°ë¶€ ì‚¬ìœ ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
    return;
  }
  
  try {
    // ì‹¤ì œ API í˜¸ì¶œ (í˜„ì¬ëŠ” ì‹œë®¬ë ˆì´ì…˜)
    await new Promise(resolve => setTimeout(resolve, 1000)); // API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜
    
    toast.success(`ì˜¨ë¼ì¸ ì˜ˆì•½ ID ${appointmentId}ì´ ê±°ë¶€ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.`);
    closeOnlineRejectionModal();
    
    // UIì—ì„œ í•´ë‹¹ í•­ëª© ì œê±°
    const listItem = document.querySelector(`button[onclick*="rejectOnlineAppointment(${appointmentId})"]`)?.closest('li');
    if (listItem) {
      listItem.style.transition = 'all 0.3s ease-out';
      listItem.style.opacity = '0';
      listItem.style.transform = 'translateX(-100%)';
      
      setTimeout(() => {
        listItem.remove();
        
        // ëª©ë¡ì´ ë¹„ì–´ìˆìœ¼ë©´ ë©”ì‹œì§€ í‘œì‹œ
        const container = document.getElementById('pending-online-appointments');
        if (container.children.length === 0) {
          container.innerHTML = '<li class="px-6 py-4 text-center text-gray-500">ëŒ€ê¸°ì¤‘ì¸ ì˜¨ë¼ì¸ ì˜ˆì•½ì´ ì—†ìŠµë‹ˆë‹¤.</li>';
        }
      }, 300);
    }
    
    // í†µê³„ ì—…ë°ì´íŠ¸
    loadAppointmentDashboard();
    
  } catch (error) {
    console.error('ì˜¨ë¼ì¸ ì˜ˆì•½ ê±°ë¶€ ì˜¤ë¥˜:', error);
    toast.error('ì˜¨ë¼ì¸ ì˜ˆì•½ ê±°ë¶€ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
  }
});

// ì˜¨ë¼ì¸ ì˜ˆì•½ ìƒíƒœ í•„í„° ë³€ê²½ ì‹œ
document.getElementById('online-status-filter').addEventListener('change', function(e) {
  const filterValue = e.target.value;
  const listItems = document.querySelectorAll('#pending-online-appointments li');
  
  listItems.forEach(item => {
    if (filterValue === '' || item.querySelector('.bg-yellow-100')) {
      item.style.display = 'block';
    } else if (filterValue === 'pending' && !item.querySelector('.bg-yellow-100')) {
      item.style.display = 'none';
    }
  });
});
</script>